INSERT INTO trigger (id, client_id, hierarchy_id, trigger_id, default_template_id, template_ids, event_name, function_name, cron_time, time_related, notification_type, mandatory, active, module, created_at, updated_at) VALUES ((SELECT GREATEST(0, MAX(id)) + 1 FROM trigger), (SELECT id FROM client WHERE name = 'Nikshay'), (SELECT id FROM hierarchy WHERE name = 'India' AND level = 1), 0, (SELECT id FROM foreign_ins_template WHERE content = 'Dear %(name) Detect TB in your close contacts by timely check -up if they develop TB symptoms like cough, fever, weight loss and loss of appetite. If TB is ruled out, they can be given TB preventive treatment to stay protected . Please consult your doctor or treatment supporter immediately for TB preventive treatment for your close contacts. For more info, call 1800-11-6666. CTD-MoHFW www.nikshay.in'), (SELECT id::text FROM foreign_ins_template WHERE content = 'Dear %(name) Detect TB in your close contacts by timely check -up if they develop TB symptoms like cough, fever, weight loss and loss of appetite. If TB is ruled out, they can be given TB preventive treatment to stay protected . Please consult your doctor or treatment supporter immediately for TB preventive treatment for your close contacts. For more info, call 1800-11-6666. CTD-MoHFW www.nikshay.in'), 'Patient_Reminder_For_Contact_Tracing', 'getEpisodesForEmptyContactTracing', '00 03 * * *', true, 'sms', false, true, 'Registry', null, null);
INSERT INTO vendor_mapping (id, deployment_id, vendor_id, trigger_registry_id, created_at, updated_at) VALUES ((SELECT GREATEST(0, MAX(id)) + 1 FROM vendor_mapping), (SELECT id FROM deployment WHERE code = 'IND'), (SELECT id FROM foreign_ins_vendor WHERE gateway = 'PLIVO'), (SELECT id FROM trigger WHERE event_name = 'Patient_Reminder_For_Contact_Tracing'), 'UTC_DATE_TIME_PLUS_0_DAY', 'UTC_DATE_TIME_PLUS_0_DAY');