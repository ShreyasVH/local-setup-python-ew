INSERT INTO trigger (id, client_id, hierarchy_id, trigger_id, default_template_id, template_ids, event_name, function_name, cron_time, time_related, notification_type, mandatory, active, module, created_at, updated_at) VALUES ((SELECT GREATEST(0, MAX(id)) + 1 FROM trigger), (SELECT id FROM client WHERE name = 'Nikshay'), (SELECT id FROM hierarchy WHERE name = 'India' AND level = 1), 0, (SELECT id FROM foreign_ins_template WHERE content = 'Dear TB survivor, We congratulate you for successfully defeating TB and overcoming the pain and suffering. Now, you can help other people with TB and be a TB Champion. This effort and commitment by you and other TB Champions will help the country to defeat TB. As a 1st step, we request you to complete the training by clicking on the link. Click %(link) to download. Login using your Nikshay ID : %(id). All the best! CTD-MoHFW www.nikshay.in'), (SELECT id::text FROM foreign_ins_template WHERE content = 'Dear TB survivor, We congratulate you for successfully defeating TB and overcoming the pain and suffering. Now, you can help other people with TB and be a TB Champion. This effort and commitment by you and other TB Champions will help the country to defeat TB. As a 1st step, we request you to complete the training by clicking on the link. Click %(link) to download. Login using your Nikshay ID : %(id). All the best! CTD-MoHFW www.nikshay.in'), 'Post_Treatment_TB_Survivor_SMS', 'getEpisodesForTBSurvivor', '00 03 * * *', true, 'sms', false, true, 'Registry', null, null);
INSERT INTO vendor_mapping (id, deployment_id, vendor_id, trigger_registry_id, created_at, updated_at) VALUES ((SELECT GREATEST(0, MAX(id)) + 1 FROM vendor_mapping), (SELECT id FROM deployment WHERE code = 'IND'), (SELECT id FROM foreign_ins_vendor WHERE gateway = 'PLIVO'), (SELECT id FROM trigger WHERE event_name = 'Post_Treatment_TB_Survivor_SMS'), 'UTC_DATE_TIME_PLUS_0_DAY', 'UTC_DATE_TIME_PLUS_0_DAY');