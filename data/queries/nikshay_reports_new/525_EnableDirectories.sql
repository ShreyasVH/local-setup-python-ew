CREATE procedure [GetSTOsDirectory] as begin SELECT Name as StateName, JSON_VALUE(ExtraData,'$.StoName') AS StoName, JSON_VALUE(ExtraData,'$.Email') AS Email, JSON_VALUE(ExtraData,'$.StoName') AS StoName, JSON_VALUE(ExtraData,'$.PhoneOffice') AS PhoneOffice, JSON_VALUE(ExtraData,'$.PhoneRes') AS PhoneRes, JSON_VALUE(ExtraData,'$.MobileNo') AS MobileNo, JSON_VALUE(ExtraData,'$.StcAddress') AS StcAddress, JSON_VALUE(ExtraData,'$.StcPincode') AS StcPincode FROM _Hierarchy where IsnotActive = 0 and type='state' end;

CREATE procedure [GetDTOsDirectory] as begin SELECT Level_2_name as StateName, Name as DistrictName, JSON_VALUE(ExtraData,'$.DtoName') AS DtoName, JSON_VALUE(ExtraData,'$.Email') AS Email, JSON_VALUE(ExtraData,'$.PhoneOffice') AS PhoneOffice, JSON_VALUE(ExtraData,'$.MobileNo') AS MobileNo, HQPHI = isnull((SELECT Name FROM _Hierarchy WHERE Id = H.HeadquarterPhi),'Not Assigned') FROM _Hierarchy H where IsnotActive = 0 and type='District' and((Level_2_Code='AP' AND (Code<>'ADB' AND Code<>'BCL' AND Code<>'HYD' AND Code<>'KMR' AND Code<>'KMM' AND Code<>'MBR' AND Code<>'MDK' AND Code<>'NGD' AND Code<>'NZD' AND Code<>'RGY' AND Code<>'WRL')) OR (Level_2_Code='AN' AND (Code<>'ANI')) OR (Level_2_Code='TN' AND (Code<>'CNI')) OR (Level_2_Code='TS' AND (Code<>'WRL')) OR (Level_2_Code='WB' AND (Code<>'CAL')) OR (Level_2_Code='MH' AND (Code<>'BMC' AND Code<>'MZ1' AND Code<>'MZ2' AND Code<>'MZ3' AND Code<>'MZ4' AND Code<>'MZ5' AND Code<>'MZ6')) OR Level_2_Code IN ('AR','AS','BI','CG','CH','DD','DL','DM','DN','GA','GU','HP','HR','JH','JK','KA','KE','LK','MG','MN','MP','MZ','NG','OR','PD','PN','RJ','SK','TR','UP','UR','LD')) order by Level_2_name, name SELECT Name as StateName FROM _Hierarchy where IsnotActive = 0 and type='state' end;

CREATE procedure [GetTBUnitDirectory] @StateId nvarchar(50)=null, @DistrictId nvarchar(50) = null as begin SELECT Level_2_Name AS StateName,Level_3_Name as DistrictName,Code as TBUnitCode,Name as TBUnitName, isnull(JSON_VALUE(ExtraData,'$.Phone') ,'')AS Phone, isnull(JSON_VALUE(ExtraData,'$.Email'),'') AS Email, isnull(JSON_VALUE(ExtraData,'$.MotcName'),'') AS MOTCName, isnull(JSON_VALUE(ExtraData,'$.MobileNo'),'') AS MobileNo, isnull(JSON_VALUE(ExtraData,'$.Sts'),'') AS STS, isnull(JSON_VALUE(ExtraData,'$.MobileSts'),'') AS MobileSTS, isnull(JSON_VALUE(ExtraData,'$.Stls'),'') AS STLS, isnull(JSON_VALUE(ExtraData,'$.MobileStls'),'') AS MobileSTLS, isnull(JSON_VALUE(ExtraData,'$.TuAddress'),'') AS TU_Address, isnull(JSON_VALUE(ExtraData,'$.TuPincode'),'') AS TU_PinCode, HQPHI = isnull((SELECT Name FROM _Hierarchy WHERE Id = H.HeadquarterPhi),'Not Assigned') FROM _Hierarchy H WHERE Type='TU' AND IsNotActive=0 and((Level_2_Code='AP' AND (Level_3_Code<>'ADB' AND Level_3_Code<>'BCL' AND Level_3_Code<>'HYD' AND Level_3_Code<>'KMR' AND Level_3_Code<>'KMM' AND Level_3_Code<>'MBR' AND Level_3_Code<>'MDK' AND Level_3_Code<>'NGD' AND Level_3_Code<>'NZD' AND Level_3_Code<>'RGY' AND Level_3_Code<>'WRL')) OR (Level_2_Code='AN' AND (Level_3_Code<>'ANI')) OR (Level_2_Code='TN' AND (Level_3_Code<>'CNI')) OR (Level_2_Code='TS' AND (Level_3_Code<>'WRL')) OR (Level_2_Code='WB' AND (Level_3_Code<>'CAL')) OR (Level_2_Code='MH' AND (Level_3_Code<>'BMC' AND Level_3_Code<>'MZ1' AND Level_3_Code<>'MZ2' AND Level_3_Code<>'MZ3' AND Level_3_Code<>'MZ4' AND Level_3_Code<>'MZ5' AND Level_3_Code<>'MZ6')) OR Level_2_Code IN ('AR','AS','BI','CG','CH','DD','DL','DM','DN','GA','GU','HP','HR','JH','JK','KA','KE','LK','MG','MN','MP','MZ','NG','OR','PD','PN','RJ','SK','TR','UP','UR','LD')) and Level_2_Id =@StateId and Level_3_Id =@DistrictId SELECT distinct Level_2_Name AS StateName FROM _Hierarchy WHERE Type='TU' AND IsNotActive=0 and ((Level_2_Code='AP' AND (Level_3_Code<>'ADB' AND Level_3_Code<>'BCL' AND Level_3_Code<>'HYD' AND Level_3_Code<>'KMR' AND Level_3_Code<>'KMM' AND Level_3_Code<>'MBR' AND Level_3_Code<>'MDK' AND Level_3_Code<>'NGD' AND Level_3_Code<>'NZD' AND Level_3_Code<>'RGY' AND Level_3_Code<>'WRL')) OR (Level_2_Code='AN' AND (Level_3_Code<>'ANI')) OR (Level_2_Code='TN' AND (Level_3_Code<>'CNI')) OR (Level_2_Code='TS' AND (Level_3_Code<>'WRL')) OR (Level_2_Code='WB' AND (Level_3_Code<>'CAL')) OR (Level_2_Code='MH' AND (Level_3_Code<>'BMC' AND Level_3_Code<>'MZ1' AND Level_3_Code<>'MZ2' AND Level_3_Code<>'MZ3' AND Level_3_Code<>'MZ4' AND Level_3_Code<>'MZ5' AND Level_3_Code<>'MZ6')) OR Level_2_Code IN ('AR','AS','BI','CG','CH','DD','DL','DM','DN','GA','GU','HP','HR','JH','JK','KA','KE','LK','MG','MN','MP','MZ','NG','OR','PD','PN','RJ','SK','TR','UP','UR','LD')) and Level_2_Id =@StateId and Level_3_Id =@DistrictId SELECT distinct Level_3_Name as DistrictName, Level_2_Name AS StateName FROM _Hierarchy WHERE Type='TU' AND IsNotActive=0 and ((Level_2_Code='AP' AND (Level_3_Code<>'ADB' AND Level_3_Code<>'BCL' AND Level_3_Code<>'HYD' AND Level_3_Code<>'KMR' AND Level_3_Code<>'KMM' AND Level_3_Code<>'MBR' AND Level_3_Code<>'MDK' AND Level_3_Code<>'NGD' AND Level_3_Code<>'NZD' AND Level_3_Code<>'RGY' AND Level_3_Code<>'WRL')) OR (Level_2_Code='AN' AND (Level_3_Code<>'ANI')) OR (Level_2_Code='TN' AND (Level_3_Code<>'CNI')) OR (Level_2_Code='TS' AND (Level_3_Code<>'WRL')) OR (Level_2_Code='WB' AND (Level_3_Code<>'CAL')) OR (Level_2_Code='MH' AND (Level_3_Code<>'BMC' AND Level_3_Code<>'MZ1' AND Level_3_Code<>'MZ2' AND Level_3_Code<>'MZ3' AND Level_3_Code<>'MZ4' AND Level_3_Code<>'MZ5' AND Level_3_Code<>'MZ6')) OR Level_2_Code IN ('AR','AS','BI','CG','CH','DD','DL','DM','DN','GA','GU','HP','HR','JH','JK','KA','KE','LK','MG','MN','MP','MZ','NG','OR','PD','PN','RJ','SK','TR','UP','UR','LD')) and Level_2_Id =@StateId and Level_3_Id =@DistrictId end;

CREATE procedure [GetPHIDirectory] @StateId nvarchar(50)=null, @DistrictId nvarchar(50) = null, @TuId nvarchar(50) = null as begin SELECT Level_2_Name AS StateName,Level_3_Name as DistrictName,Level_4_Code as TUCode,Level_4_Name as TBUnitName,Code as PHICode,Name as PHIName, isnull(JSON_VALUE(ExtraData,'$.Dmc'),'') AS IsMicroscopy, isnull(JSON_VALUE(ExtraData,'$.Cbnaat'),'') AS IsCbnaat FROM _Hierarchy WHERE Type='PHI' AND IsNotActive=0 and((Level_2_Code='AP' AND (Level_3_Code<>'ADB' AND Level_3_Code<>'BCL' AND Level_3_Code<>'HYD' AND Level_3_Code<>'KMR' AND Level_3_Code<>'KMM' AND Level_3_Code<>'MBR' AND Level_3_Code<>'MDK' AND Level_3_Code<>'NGD' AND Level_3_Code<>'NZD' AND Level_3_Code<>'RGY' AND Level_3_Code<>'WRL')) OR (Level_2_Code='AN' AND (Level_3_Code<>'ANI')) OR (Level_2_Code='TN' AND (Level_3_Code<>'CNI')) OR (Level_2_Code='TS' AND (Level_3_Code<>'WRL')) OR (Level_2_Code='WB' AND (Level_3_Code<>'CAL')) OR (Level_2_Code='MH' AND (Level_3_Code<>'BMC' AND Level_3_Code<>'MZ1' AND Level_3_Code<>'MZ2' AND Level_3_Code<>'MZ3' AND Level_3_Code<>'MZ4' AND Level_3_Code<>'MZ5' AND Level_3_Code<>'MZ6')) OR Level_2_Code IN ('AR','AS','BI','CG','CH','DD','DL','DM','DN','GA','GU','HP','HR','JH','JK','KA','KE','LK','MG','MN','MP','MZ','NG','OR','PD','PN','RJ','SK','TR','UP','UR','LD')) and Level_2_Id =@StateId and Level_3_Id =@DistrictId and Level_4_Id =@TuId ORDER BY Level_2_Name ASC SELECT distinct Level_2_Name AS StateName FROM _Hierarchy WHERE Type='PHI' AND IsNotActive=0 and ((Level_2_Code='AP' AND (Level_3_Code<>'ADB' AND Level_3_Code<>'BCL' AND Level_3_Code<>'HYD' AND Level_3_Code<>'KMR' AND Level_3_Code<>'KMM' AND Level_3_Code<>'MBR' AND Level_3_Code<>'MDK' AND Level_3_Code<>'NGD' AND Level_3_Code<>'NZD' AND Level_3_Code<>'RGY' AND Level_3_Code<>'WRL')) OR (Level_2_Code='AN' AND (Level_3_Code<>'ANI')) OR (Level_2_Code='TN' AND (Level_3_Code<>'CNI')) OR (Level_2_Code='TS' AND (Level_3_Code<>'WRL')) OR (Level_2_Code='WB' AND (Level_3_Code<>'CAL')) OR (Level_2_Code='MH' AND (Level_3_Code<>'BMC' AND Level_3_Code<>'MZ1' AND Level_3_Code<>'MZ2' AND Level_3_Code<>'MZ3' AND Level_3_Code<>'MZ4' AND Level_3_Code<>'MZ5' AND Level_3_Code<>'MZ6')) OR Level_2_Code IN ('AR','AS','BI','CG','CH','DD','DL','DM','DN','GA','GU','HP','HR','JH','JK','KA','KE','LK','MG','MN','MP','MZ','NG','OR','PD','PN','RJ','SK','TR','UP','UR','LD')) and Level_2_Id =@StateId and Level_3_Id =@DistrictId and Level_4_Id =@TuId ORDER BY Level_2_Name ASC SELECT distinct Level_3_Name as DistrictName, Level_2_Name AS StateName FROM _Hierarchy WHERE Type='PHI' AND IsNotActive=0 and ((Level_2_Code='AP' AND (Level_3_Code<>'ADB' AND Level_3_Code<>'BCL' AND Level_3_Code<>'HYD' AND Level_3_Code<>'KMR' AND Level_3_Code<>'KMM' AND Level_3_Code<>'MBR' AND Level_3_Code<>'MDK' AND Level_3_Code<>'NGD' AND Level_3_Code<>'NZD' AND Level_3_Code<>'RGY' AND Level_3_Code<>'WRL')) OR (Level_2_Code='AN' AND (Level_3_Code<>'ANI')) OR (Level_2_Code='TN' AND (Level_3_Code<>'CNI')) OR (Level_2_Code='TS' AND (Level_3_Code<>'WRL')) OR (Level_2_Code='WB' AND (Level_3_Code<>'CAL')) OR (Level_2_Code='MH' AND (Level_3_Code<>'BMC' AND Level_3_Code<>'MZ1' AND Level_3_Code<>'MZ2' AND Level_3_Code<>'MZ3' AND Level_3_Code<>'MZ4' AND Level_3_Code<>'MZ5' AND Level_3_Code<>'MZ6')) OR Level_2_Code IN ('AR','AS','BI','CG','CH','DD','DL','DM','DN','GA','GU','HP','HR','JH','JK','KA','KE','LK','MG','MN','MP','MZ','NG','OR','PD','PN','RJ','SK','TR','UP','UR','LD')) and Level_2_Id =@StateId and Level_3_Id =@DistrictId and Level_4_Id =@TuId ORDER BY Level_2_Name ASC SELECT distinct Level_4_Name as TBUnitName, Level_2_Name AS StateName,Level_3_Name as DistrictName FROM _Hierarchy WHERE Type='PHI' AND IsNotActive=0 and ((Level_2_Code='AP' AND (Level_3_Code<>'ADB' AND Level_3_Code<>'BCL' AND Level_3_Code<>'HYD' AND Level_3_Code<>'KMR' AND Level_3_Code<>'KMM' AND Level_3_Code<>'MBR' AND Level_3_Code<>'MDK' AND Level_3_Code<>'NGD' AND Level_3_Code<>'NZD' AND Level_3_Code<>'RGY' AND Level_3_Code<>'WRL')) OR (Level_2_Code='AN' AND (Level_3_Code<>'ANI')) OR (Level_2_Code='TN' AND (Level_3_Code<>'CNI')) OR (Level_2_Code='TS' AND (Level_3_Code<>'WRL')) OR (Level_2_Code='WB' AND (Level_3_Code<>'CAL')) OR (Level_2_Code='MH' AND (Level_3_Code<>'BMC' AND Level_3_Code<>'MZ1' AND Level_3_Code<>'MZ2' AND Level_3_Code<>'MZ3' AND Level_3_Code<>'MZ4' AND Level_3_Code<>'MZ5' AND Level_3_Code<>'MZ6')) OR Level_2_Code IN ('AR','AS','BI','CG','CH','DD','DL','DM','DN','GA','GU','HP','HR','JH','JK','KA','KE','LK','MG','MN','MP','MZ','NG','OR','PD','PN','RJ','SK','TR','UP','UR','LD')) and Level_2_Id =@StateId and Level_3_Id =@DistrictId and Level_4_Id =@TuId ORDER BY Level_2_Name ASC end;