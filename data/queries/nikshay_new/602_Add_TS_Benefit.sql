INSERT INTO _Beneficiary (BankAccountNo, BankId, PfmsStatus, PfmsId, LastUpdatedManuallyBy, LastUpdatedManuallyAt, ValidatedBeneficiaryName, StateCode, DistrictCode, AddedbyDbtMigration, TempBeneficiaryType, TempNikshayBeneficiaryId, PfmsStatusTribal, BeneficiaryName, ValidatingPfmsAgency, CurrentPfmsAgency, LastBenefitSentToPfmsOn, TempNikshayId, TempMigrationId, PfmsIdTribal, EntityType, IsDeleted, DuplicateCount, StatusBeforeApproval, NewBankId, NewBankAccountNo, IsVerifiedDuplicate, PfmsStatusInformant, PfmsIdInformant, PhotoProof, AccountOwner, CreatedAt, UpdatedAt) VALUES (null, null, N'EMPTY', null, null, null, null, N'29', N'536', 0, null, null, N'EMPTY', N'TS Benefit', null, null, null, null, null, null, N'C_Patient', 0, 0, null, null, null, 0, N'EMPTY', null, null, null, 'DATE_TIME_PLUS_0_DAY', 'DATE_TIME_PLUS_0_DAY');
INSERT INTO _BeneficiaryEntityLinkage (BeneficiaryId, EntityId, EntityType) VALUES ((SELECT id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), (SELECT Id FROM Foreign_Persons WHERE FirstName = 'TS' AND LastName = 'Benefit'), N'Person');

INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'Id', null, CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatus', null, N'EMPTY', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'CreatedAt', null, N'DATE_TIME_PLUS_0_DAY_DATE_FIRST', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'UpdatedAt', null, N'DATE_TIME_PLUS_0_DAY_DATE_FIRST', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'StateCode', null, N'29', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'DistrictCode', null, N'536', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'AddedbyDbtMigration', null, N'False', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatusTribal', null, N'EMPTY', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'BeneficiaryName', null, N'TS Benefit', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'EntityType', null, N'C_Patient', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'IsDeleted', null, N'False', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'DuplicateCount', null, N'0', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'IsVerifiedDuplicate', null, N'False', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatusInformant', null, N'EMPTY', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_0_DAY');

INSERT INTO _DiagnosticsSample (DiagSampleId, SampleCollectionSite, SampleReferralSite, AddedOn, LastUpdatedOn, SampleReferralDate) VALUES (12, CAST((SELECT Id FROM Foreign_Hierarchies WHERE Name = 'tribal phi' AND Level = 5) as nvarchar(50)), null, 'DATE_TIME_PLUS_5_MINUTE', null, null);

INSERT INTO _TestResult (PatientId, Type, Specimen, VisualAppearanceSputum, ReportedBy, DateTested, DateReported, HierarchyMapping, TestingFacilityName, TestData, Valid, Positive, AddedBy, LastUpdatedBy, AddedOn, LastUpdatedOn, Stage, Status, Reason, SubReason, PredominantSymptom, PredominantSymptomDuration, HCPVisited, PreviousATT, NikshaySourceTable, NikshaySourceId, DateSpecimenCollected, DiagRequestId, keep, duplicateOf) VALUES ((Select Id FROM Foreign_Episodes WHERE FirstName = 'TS' AND LastName = 'Benefit'), N'Microscopy ZN and Fluorescent', N'Sputum', N'Mucopurulent', null, null, 'DATE_MINUS_3_DAY', 10, N'dmc lab', N'{"FinalInterpretation":"Positive","Remarks":null}', 0, null, (SELECT Id FROM _UserAccess WHERE Username = 'phi-KADHA02-001'), (SELECT Id FROM _UserAccess WHERE Username = 'phi-KADHA02-001'), 'DATE_TIME_PLUS_5_MINUTE', 'DATE_TIME_PLUS_5_MINUTE', null, N'Results Available', N'Diagnosis of DSTB', N'', null, null, null, 0, null, null, 'DATE_MINUS_4_DAY', 12, 1, null);

INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Id', null, CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'PatientId', null, CAST((SELECT Id FROM Foreign_Episodes WHERE FirstName = 'TS' AND LastName = 'Benefit') as nvarchar(50)), N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Type', null, N'Microscopy ZN and Fluorescent', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Specimen', null, N'Sputum', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'VisualAppearanceSputum', null, N'Mucopurulent', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'DateReported', null, 'DATE_MINUS_3_DAY_DATE_FIRST', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'HierarchyMapping', null, N'10', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'TestingFacilityName', null, N'dmc lab', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'TestData', null, N'{"FinalInterpretation":"Positive","Remarks":null}', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Valid', null, N'False', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'AddedBy', null, CAST((SELECT Id FROM _UserAccess WHERE Username = 'phi-KADHA02-001') as nvarchar(50)), N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'LastUpdatedBy', null, CAST((SELECT Id FROM _UserAccess WHERE Username = 'phi-KADHA02-001') as nvarchar(50)), N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'AddedOn', null, 'DATE_TIME_PLUS_5_MINUTE_DATE_FIRST', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'LastUpdatedOn', null, 'DATE_TIME_PLUS_5_MINUTE_DATE_FIRST', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Status', null, N'Results Available', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Reason', null, N'Diagnosis of DSTB', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'PreviousATT', null, N'False', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'DateSpecimenCollected', null, 'DATE_MINUS_4_DAY_DATE_FIRST', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'DiagRequestId', null, N'12', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');

#add bank details
UPDATE _Beneficiary SET BankAccountNo = '64000000009', BankId = (SELECT MAX(Id) FROM _BankPfms), PfmsStatus = 'ENTERED', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = 'phi-KADHA02-001'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_10_MINUTE', PfmsStatusTribal = 'ENTERED', PfmsStatusInformant = 'ENTERED', SeededAt = 'DATE_TIME_PLUS_10_MINUTE' WHERE BeneficiaryName = 'TS Benefit';

INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'BankAccountNo', null, N'64000000009', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'BankId', null, CAST((SELECT MAX(Id) FROM _BankPfms) as nvarchar(50)), N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatus', N'EMPTY', N'ENTERED', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'LastUpdatedManuallyBy', null, CAST((SELECT Id FROM _UserAccess WHERE Username = 'phi-KADHA02-001') as nvarchar(50)), N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'LastUpdatedManuallyAt', null, 'DATE_TIME_PLUS_10_MINUTE_DATE_FIRST', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'SeededAt', null, 'DATE_TIME_PLUS_10_MINUTE_DATE_FIRST', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'UpdatedAt', 'DATE_TIME_PLUS_9_MINUTE_DATE_FIRST', 'DATE_TIME_PLUS_10_MINUTE_DATE_FIRST', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatusTribal', N'EMPTY', N'ENTERED', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatusInformant', N'EMPTY', N'ENTERED', N'phi-KADHA02-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');

#generate beneficiary job
UPDATE _Beneficiary SET PfmsStatus = 'SENT', PfmsStatusInformant = 'SENT', PfmsStatusTribal = 'SENT' WHERE BeneficiaryName = 'TS Benefit';
INSERT INTO _BeneficiaryBatch (Id, RequestUniqueMessageId, RequestMessageDateTime, RequestRecordsCount, DataSource, Destination, InitiatingPartyName, InitiatingPartyCode, BatchDate, DaySerialNo, BatchFileCreated, UploadedToPfms, UploadedToPfmsAt, Responses, NoOfResponsesReceived, LastUpdatedAt, PfmsAgencyMapping) VALUES (N'CB0038DATE_PLUS_0_DAY_DDMMYY0005', N'0038DBTBENREQDATE_PLUS_0_DAY_DDMMYYYY5', N'DATE_TIME_PLUS_15_MINUTE', 1, N'0038', N'CPSMS', N'Tribal Agency', CAST((SELECT Code FROM _PfmsAgency WHERE Name = 'Tribal Agency') AS nvarchar(50)), N'DATE_PLUS_0_DAY', 5, 1, 0, null, null, 0, N'DATE_TIME_PLUS_0_DAY', CAST((SELECT Id FROM _PfmsAgency WHERE Name = 'Tribal Agency') AS nvarchar(50)));
INSERT INTO _BeneficiaryBatch (Id, RequestUniqueMessageId, RequestMessageDateTime, RequestRecordsCount, DataSource, Destination, InitiatingPartyName, InitiatingPartyCode, BatchDate, DaySerialNo, BatchFileCreated, UploadedToPfms, UploadedToPfmsAt, Responses, NoOfResponsesReceived, LastUpdatedAt, PfmsAgencyMapping) VALUES (N'CB0038DATE_PLUS_0_DAY_DDMMYY0006', N'0038DBTBENREQDATE_PLUS_0_DAY_DDMMYYYY6', N'DATE_TIME_PLUS_15_MINUTE', 1, N'0038', N'CPSMS', N'Tribal Agency', CAST((SELECT Code FROM _PfmsAgency WHERE Name = 'Tribal Agency') AS nvarchar(50)), N'DATE_PLUS_0_DAY', 6, 1, 0, null, null, 0, N'DATE_TIME_PLUS_0_DAY', CAST((SELECT Id FROM _PfmsAgency WHERE Name = 'Tribal Agency') AS nvarchar(50)));
INSERT INTO _BeneficiaryBatch (Id, RequestUniqueMessageId, RequestMessageDateTime, RequestRecordsCount, DataSource, Destination, InitiatingPartyName, InitiatingPartyCode, BatchDate, DaySerialNo, BatchFileCreated, UploadedToPfms, UploadedToPfmsAt, Responses, NoOfResponsesReceived, LastUpdatedAt, PfmsAgencyMapping) VALUES (N'CB0038DATE_PLUS_0_DAY_DDMMYY0007', N'0038DBTBENREQDATE_PLUS_0_DAY_DDMMYYYY7', N'DATE_TIME_PLUS_15_MINUTE', 1, N'0038', N'CPSMS', N'Tribal Agency', CAST((SELECT Code FROM _PfmsAgency WHERE Name = 'Tribal Agency') AS nvarchar(50)), N'DATE_PLUS_0_DAY', 7, 1, 0, null, null, 0, N'DATE_TIME_PLUS_0_DAY', CAST((SELECT Id FROM _PfmsAgency WHERE Name = 'Tribal Agency') AS nvarchar(50)));
INSERT INTO _BeneficiaryRequest (BatchId, BeneficiaryId, AgencyId, SchemeCode, Purpose, PfmsBeneficiaryCode, BeneficiaryType, BeneficiaryName, Gender, Address, DistrictCensusCode, BankName, BranchId, BankAccountNo, ResponseInMessageId, BeneficiaryStatus, RejectionReasonCode, RejectionReasonNarration, BankResponse, CreatedAt, LastUpdatedAt, AgencyName, StateCensusCode) VALUES (N'CB0038DATE_PLUS_0_DAY_DDMMYY0005', (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), CAST((SELECT Code FROM _PfmsAgency WHERE Name = 'Tribal Agency') AS nvarchar(50)), N'KA182', N'A', null, N'4282', N'TS Benefit', N'M', N'Address', N'536', CAST((SELECT BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON bp.id = b.BankId AND b.BeneficiaryName = 'TS Benefit') as NVARCHAR(50)), CAST((SELECT IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp ON bp.id = b.BankId AND b.BeneficiaryName = 'TS Benefit') as NVARCHAR(50)), CAST((SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as NVARCHAR(50)), null, null, null, null, null, N'DATE_TIME_PLUS_15_MINUTE', 'DATE_TIME_PLUS_15_MINUTE', N'Tribal Agency', N'29');
INSERT INTO _BeneficiaryRequest (BatchId, BeneficiaryId, AgencyId, SchemeCode, Purpose, PfmsBeneficiaryCode, BeneficiaryType, BeneficiaryName, Gender, Address, DistrictCensusCode, BankName, BranchId, BankAccountNo, ResponseInMessageId, BeneficiaryStatus, RejectionReasonCode, RejectionReasonNarration, BankResponse, CreatedAt, LastUpdatedAt, AgencyName, StateCensusCode) VALUES (N'CB0038DATE_PLUS_0_DAY_DDMMYY0006', (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), CAST((SELECT Code FROM _PfmsAgency WHERE Name = 'Tribal Agency') AS nvarchar(50)), N'KA182', N'A', null, N'4283', N'TS Benefit', N'M', N'Address', N'536', CAST((SELECT BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON bp.id = b.BankId AND b.BeneficiaryName = 'TS Benefit') as NVARCHAR(50)), CAST((SELECT IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp ON bp.id = b.BankId AND b.BeneficiaryName = 'TS Benefit') as NVARCHAR(50)), CAST((SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as NVARCHAR(50)), null, null, null, null, null, N'DATE_TIME_PLUS_15_MINUTE', 'DATE_TIME_PLUS_15_MINUTE', N'Tribal Agency', N'29');
INSERT INTO _BeneficiaryRequest (BatchId, BeneficiaryId, AgencyId, SchemeCode, Purpose, PfmsBeneficiaryCode, BeneficiaryType, BeneficiaryName, Gender, Address, DistrictCensusCode, BankName, BranchId, BankAccountNo, ResponseInMessageId, BeneficiaryStatus, RejectionReasonCode, RejectionReasonNarration, BankResponse, CreatedAt, LastUpdatedAt, AgencyName, StateCensusCode) VALUES (N'CB0038DATE_PLUS_0_DAY_DDMMYY0007', (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), CAST((SELECT Code FROM _PfmsAgency WHERE Name = 'Tribal Agency') AS nvarchar(50)), N'KA182', N'A', null, N'4281', N'TS Benefit', N'M', N'Not Available', N'536', CAST((SELECT BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON bp.id = b.BankId AND b.BeneficiaryName = 'TS Benefit') as NVARCHAR(50)), CAST((SELECT IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp ON bp.id = b.BankId AND b.BeneficiaryName = 'TS Benefit') as NVARCHAR(50)), CAST((SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as NVARCHAR(50)), null, null, null, null, null, N'DATE_TIME_PLUS_15_MINUTE', 'DATE_TIME_PLUS_15_MINUTE', N'Tribal Agency', N'29');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatus', N'ENTERED', N'SENT', N'Unknown', 'UTC_DATE_TIME_PLUS_15_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'UpdatedAt', 'DATE_TIME_PLUS_10_MINUTE_DATE_FIRST', 'DATE_TIME_PLUS_15_MINUTE_DATE_FIRST', N'Unknown', 'UTC_DATE_TIME_PLUS_15_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'UpdatedAt', 'DATE_TIME_PLUS_11_MINUTE_DATE_FIRST', 'DATE_TIME_PLUS_15_MINUTE_DATE_FIRST', N'Unknown', 'UTC_DATE_TIME_PLUS_15_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatusTribal', N'ENTERED', N'SENT', N'Unknown', 'UTC_DATE_TIME_PLUS_15_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'UpdatedAt', 'DATE_TIME_PLUS_15_MINUTE_DATE_FIRST', 'DATE_TIME_PLUS_15_MINUTE_DATE_FIRST', N'Unknown', 'UTC_DATE_TIME_PLUS_15_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatusInformant', N'ENTERED', N'SENT', N'Unknown', 'UTC_DATE_TIME_PLUS_15_MINUTE');

# upload beneficiaries jpb
UPDATE _BeneficiaryBatch SET UploadedToPfms = 1, UploadedToPfmsAt = 'DATE_TIME_PLUS_16_MINUTE', LastUpdatedAt = 'DATE_TIME_PLUS_16_MINUTE' WHERE Id = 'CB0038DATE_PLUS_0_DAY_DDMMYY0005';
UPDATE _BeneficiaryBatch SET UploadedToPfms = 1, UploadedToPfmsAt = 'DATE_TIME_PLUS_16_MINUTE', LastUpdatedAt = 'DATE_TIME_PLUS_16_MINUTE' WHERE Id = 'CB0038DATE_PLUS_0_DAY_DDMMYY0006';
UPDATE _BeneficiaryBatch SET UploadedToPfms = 1, UploadedToPfmsAt = 'DATE_TIME_PLUS_16_MINUTE', LastUpdatedAt = 'DATE_TIME_PLUS_16_MINUTE' WHERE Id = 'CB0038DATE_PLUS_0_DAY_DDMMYY0007';

#download and read beneficiary job
UPDATE _Beneficiary SET PfmsStatus = 'VALIDATED', ValidatedBeneficiaryName = 'TS Benefit', PfmsId = CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), PfmsStatusInformant = 'VALIDATED', PfmsIdInformant = CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), PfmsStatusTribal = 'VALIDATED', PfmsIdTribal = CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)) WHERE BeneficiaryName = 'TS Benefit';
UPDATE _BeneficiaryRequest SET ResponseInMessageId = '0038DBTBENRESDATE_PLUS_0_DAY_DDMMYYYY5', BeneficiaryStatus = 'ACCP', BankResponse = '[{"BankName":"SBI","BranchId":"SBIN0012345","BankAccountNumber":"64000000009","BeneficiaryTitle":null,"BeneficiaryName":null}]', PfmsBeneficiaryCode = CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), LastUpdatedAt = 'DATE_TIME_PLUS_17_MINUTE' WHERE BatchId = 'CB0038DATE_PLUS_0_DAY_DDMMYY0005';
UPDATE _BeneficiaryRequest SET ResponseInMessageId = '0038DBTBENRESDATE_PLUS_0_DAY_DDMMYYYY6', BeneficiaryStatus = 'ACCP', BankResponse = '[{"BankName":"SBI","BranchId":"SBIN0012345","BankAccountNumber":"64000000009","BeneficiaryTitle":null,"BeneficiaryName":null}]', PfmsBeneficiaryCode = CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), LastUpdatedAt = 'DATE_TIME_PLUS_17_MINUTE' WHERE BatchId = 'CB0038DATE_PLUS_0_DAY_DDMMYY0006';
UPDATE _BeneficiaryRequest SET ResponseInMessageId = '0038DBTBENRESDATE_PLUS_0_DAY_DDMMYYYY7', BeneficiaryStatus = 'ACCP', BankResponse = '[{"BankName":"SBI","BranchId":"SBIN0012345","BankAccountNumber":"64000000009","BeneficiaryTitle":null,"BeneficiaryName":null}]', PfmsBeneficiaryCode = CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), LastUpdatedAt = 'DATE_TIME_PLUS_17_MINUTE' WHERE BatchId = 'CB0038DATE_PLUS_0_DAY_DDMMYY0007';
UPDATE _BeneficiaryBatch SET Responses = '[{"MessageId":"0038DBTBENRESDATE_PLUS_0_DAY_DDMMYYYY5","MessageDateTime":"DATE_TIME_PLUS_17_MINUTE_WITH_TIMEZONE_SEPARATION","RecordCount":1,"ReadAt":"DATE_TIME_PLUS_17_MINUTE_WITH_TIMEZONE_SEPARATION"}]', NoOfResponsesReceived = 1, LastUpdatedAt = 'DATE_TIME_PLUS_17_MINUTE' WHERE Id = 'CB0038DATE_PLUS_0_DAY_DDMMYY0005';
UPDATE _BeneficiaryBatch SET Responses = '[{"MessageId":"0038DBTBENRESDATE_PLUS_0_DAY_DDMMYYYY6","MessageDateTime":"DATE_TIME_PLUS_17_MINUTE_WITH_TIMEZONE_SEPARATION","RecordCount":1,"ReadAt":"DATE_TIME_PLUS_17_MINUTE_WITH_TIMEZONE_SEPARATION"}]', NoOfResponsesReceived = 1, LastUpdatedAt = 'DATE_TIME_PLUS_17_MINUTE' WHERE Id = 'CB0038DATE_PLUS_0_DAY_DDMMYY0006';
UPDATE _BeneficiaryBatch SET Responses = '[{"MessageId":"0038DBTBENRESDATE_PLUS_0_DAY_DDMMYYYY7","MessageDateTime":"DATE_TIME_PLUS_17_MINUTE_WITH_TIMEZONE_SEPARATION","RecordCount":1,"ReadAt":"DATE_TIME_PLUS_17_MINUTE_WITH_TIMEZONE_SEPARATION"}]', NoOfResponsesReceived = 1, LastUpdatedAt = 'DATE_TIME_PLUS_17_MINUTE' WHERE Id = 'CB0038DATE_PLUS_0_DAY_DDMMYY0007';
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatus', N'SENT', N'VALIDATED', N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsId', null, CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'ValidatedBeneficiaryName', null, N'TS Benefit', N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatusTribal', N'SENT', N'VALIDATED', N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsIdTribal', null, CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsStatusInformant', N'SENT', N'VALIDATED', N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'PfmsIdInformant', null, CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');

# generate benefit job
INSERT INTO _Benefit (BeneficiaryId, HierarchyMapping, Scheme, IncentiveNumber, Status, Amount, Log, CreatedAt, LastUpdatedManuallyBy, LastUpdatedManuallyAt, ProcessingAccountNo, ProcessingIfscCode, ProcessingAgencyCode, Purpose, EpisodeId, IsDeleted, UpdatedAt) VALUES ((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), (SELECT Id FROM Foreign_Hierarchies WHERE Name = 'tuTribal' AND Level = 4), N'NS', 1, N'MAKER_PENDING', 3000.00, N'[{"userName":"NIKSHAY","action":"COMMENT","comment":"First Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]', 'DATE_TIME_PLUS_18_MINUTE', null, null, null, null, null, N'7175', (Select Id FROM Foreign_Episodes WHERE FirstName = 'TS' AND LastName = 'Benefit'), 0, 'DATE_TIME_PLUS_18_MINUTE');
INSERT INTO _Benefit (BeneficiaryId, HierarchyMapping, Scheme, IncentiveNumber, Status, Amount, Log, CreatedAt, LastUpdatedManuallyBy, LastUpdatedManuallyAt, ProcessingAccountNo, ProcessingIfscCode, ProcessingAgencyCode, Purpose, EpisodeId, IsDeleted, UpdatedAt) VALUES ((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), (SELECT Id FROM Foreign_Hierarchies WHERE Name = 'tuTribal' AND Level = 4), N'TS', null, N'MAKER_PENDING', 750.00, N'[{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Tribal Support Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]', 'DATE_TIME_PLUS_18_MINUTE', null, null, null, null, null, N'7176', (Select Id FROM Foreign_Episodes WHERE FirstName = 'TS' AND LastName = 'Benefit'), 0, 'DATE_TIME_PLUS_18_MINUTE');

# DBT maker approval
UPDATE _Benefit SET Status = 'APPROVER_PENDING', Log = '[{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"First Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999938'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_20_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'NS' AND IncentiveNumber = 1;
UPDATE _Benefit SET Status = 'APPROVER_PENDING', Log = '[{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Tribal Support Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999938'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_20_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'TS';

# DBT checker approval
UPDATE _Benefit SET Status = 'PFMS_PENDING', Log = '[{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999934","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"First Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999947'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_20_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'NS' AND IncentiveNumber = 1;
UPDATE _Benefit SET Status = 'PFMS_PENDING', Log = '[{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999934","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Tribal Support Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999947'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_20_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'TS';

# generate and upload benefit job
INSERT INTO _BenefitsBatch (RequestUniqueMessageId, BatchId, BatchDate, DaySerialNo, RequestMessageDateTime, RequestRecordCount, RequestControlSum, DataSource, Destination, InitiatingPartyName, InitiatingPartyCode, BatchFileCreated, UploadedToPfms, UploadedToPfmsAt, AckReceived, AckReadAt, AckMessageId, AckNoOfRecords, AckBatchStatus, Responses, NoOfResponsesReceived, LastUpdatedAt, PfmsAgencyMapping, CentreAuthorityCode, AckMessageDateTime, AckRejectionCode, AckRejectionNarration, NoOfRetires, IsSigned, RequiredSignatureCount, Scheme, LastReviewedAt, ApprovalStatus, SchemeCode, CreatedAt) VALUES (N'0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY5', N'CP0038DATE_PLUS_0_DAY_DDMMYY0005', N'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', 5, N'DATE_TIME_PLUS_22_MINUTE', 1, 3000.00, N'0038', N'CPSMS', N'Tribal Agency', (SELECT Code FROM _PfmsAgency WHERE Name = 'Tribal Agency'), 1, 1, N'DATE_TIME_PLUS_22_MINUTE', 0, null, null, null, null, null, 0, N'DATE_TIME_PLUS_22_MINUTE', (SELECT Id FROM _PfmsAgency WHERE Name = 'Tribal Agency'), N'EID2L', null, null, null, null, 0, null, N'NS', null, null, N'KA182', 'DATE_TIME_PLUS_22_MINUTE');
INSERT INTO _BenefitsBatch (RequestUniqueMessageId, BatchId, BatchDate, DaySerialNo, RequestMessageDateTime, RequestRecordCount, RequestControlSum, DataSource, Destination, InitiatingPartyName, InitiatingPartyCode, BatchFileCreated, UploadedToPfms, UploadedToPfmsAt, AckReceived, AckReadAt, AckMessageId, AckNoOfRecords, AckBatchStatus, Responses, NoOfResponsesReceived, LastUpdatedAt, PfmsAgencyMapping, CentreAuthorityCode, AckMessageDateTime, AckRejectionCode, AckRejectionNarration, NoOfRetires, IsSigned, RequiredSignatureCount, Scheme, LastReviewedAt, ApprovalStatus, SchemeCode, CreatedAt) VALUES (N'0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY6', N'CP0038DATE_PLUS_0_DAY_DDMMYY0006', N'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', 6, N'DATE_TIME_PLUS_22_MINUTE', 1, 750.00, N'0038', N'CPSMS', N'Tribal Agency', (SELECT Code FROM _PfmsAgency WHERE Name = 'Tribal Agency'), 1, 1, N'DATE_TIME_PLUS_22_MINUTE', 0, null, null, null, null, null, 0, N'DATE_TIME_PLUS_22_MINUTE', (SELECT Id FROM _PfmsAgency WHERE Name = 'Tribal Agency'), N'E8TDP', null, null, null, null, 0, null, N'TS', null, null, N'KA182', 'DATE_TIME_PLUS_22_MINUTE');
INSERT INTO _BenefitTransaction (BenefitId, BeneficiaryId, BankName, BranchCode, PfmsBeneficiaryCode, BeneficiaryName, BeneficiaryType, DistrictCode, BankAccountNo, Amount, PaymentFromDate, PaymentToDate, Status, AckStatus, AckRejectReasonCode, AckRejectReasonNarration, PfmsTransactionId, PfmsTransactionStatus, CreditDate, RejectionReasonCode, RejectionReasonNarration, BankAccountHolderDetails, ResponseInMessageId, CreatedAt, LastUpdatedAt, PaymentPurpose, HierarchyMapping, StateCode, InstructionId, TempNikshayBeneficiaryId, RequestMessageId, IsGroupTransaction, GroupId) VALUES ((SELECT Id from _Benefit WHERE BeneficiaryId = (Select Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'NS' AND IncentiveNumber = 1), (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), (SELECT bp.BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON b.BankId = bp.Id AND b.BeneficiaryName = 'TS Benefit'), (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp ON b.BankId = bp.Id AND b.BeneficiaryName = 'TS Benefit'), CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AS nvarchar(50)), N'TS Benefit', N'4282', N'536', (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), 3000.00, 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', N'SENT_TO_PFMS', null, null, null, null, null, null, null, null, null, null, 'DATE_TIME_PLUS_22_MINUTE', 'DATE_TIME_PLUS_22_MINUTE', N'7942', (SELECT Id FROM Foreign_Hierarchies WHERE Name = 'tuTribal' AND Level = 4), N'29', null, null, N'0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY5', 0, null);
INSERT INTO _BenefitTransaction (BenefitId, BeneficiaryId, BankName, BranchCode, PfmsBeneficiaryCode, BeneficiaryName, BeneficiaryType, DistrictCode, BankAccountNo, Amount, PaymentFromDate, PaymentToDate, Status, AckStatus, AckRejectReasonCode, AckRejectReasonNarration, PfmsTransactionId, PfmsTransactionStatus, CreditDate, RejectionReasonCode, RejectionReasonNarration, BankAccountHolderDetails, ResponseInMessageId, CreatedAt, LastUpdatedAt, PaymentPurpose, HierarchyMapping, StateCode, InstructionId, TempNikshayBeneficiaryId, RequestMessageId, IsGroupTransaction, GroupId) VALUES ((SELECT Id from _Benefit WHERE BeneficiaryId = (Select Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'TS'), (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), (SELECT bp.BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON b.BankId = bp.Id AND b.BeneficiaryName = 'TS Benefit'), (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp ON b.BankId = bp.Id AND b.BeneficiaryName = 'TS Benefit'), CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AS nvarchar(50)), N'TS Benefit', N'4283', N'536', (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), 750.00, 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', N'SENT_TO_PFMS', null, null, null, null, null, null, null, null, null, null, 'DATE_TIME_PLUS_22_MINUTE', 'DATE_TIME_PLUS_22_MINUTE', N'7176', (SELECT Id FROM Foreign_Hierarchies WHERE Name = 'tuTribal' AND Level = 4), N'29', null, null, N'0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY6', 0, null);
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'UpdatedAt', 'DATE_TIME_PLUS_12_MINUTE_DATE_FIRST', 'DATE_TIME_PLUS_23_MINUTE_DATE_FIRST', N'Unknown', 'UTC_DATE_TIME_PLUS_23_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') as nvarchar(50)), N'LastBenefitSentToPfmsOn', null, N'DATE_PLUS_0_DAY_DATE_FIRST', N'Unknown', 'UTC_DATE_TIME_PLUS_23_MINUTE');
UPDATE _Beneficiary SET LastBenefitSentToPfmsOn = 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY' WHERE BeneficiaryName = 'TS Benefit';
UPDATE _Benefit SET Status = 'PFMS_SENT', Log = '[{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY5","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999934","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"First Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]', ProcessingAccountNo = (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), ProcessingIfscCode =  (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp on bp.Id = b.BankId and b.BeneficiaryName = 'TS Benefit'), ProcessingAgencyCode = (SELECT Code FROM _PfmsAgency WHERE Name = 'Tribal Agency') WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'NS' AND IncentiveNumber = 1;
UPDATE _Benefit SET Status = 'PFMS_SENT', Log = '[{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY6","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999934","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Tribal Support Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]', ProcessingAccountNo = (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit'), ProcessingIfscCode =  (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp on bp.Id = b.BankId and b.BeneficiaryName = 'TS Benefit'), ProcessingAgencyCode = (SELECT Code FROM _PfmsAgency WHERE Name = 'Tribal Agency') WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'TS';

# download and read benefits job
UPDATE _BenefitsBatch SET AckReceived = 1, AckReadAt = 'DATE_TIME_PLUS_23_MINUTE', AckMessageId = '0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY5', AckNoOfRecords = 1, AckBatchStatus = 'ACPT', AckMessageDateTime = 'DATE_TIME_PLUS_23_MINUTE' WHERE RequestUniqueMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY5';
UPDATE _BenefitsBatch SET AckReceived = 1, AckReadAt = 'DATE_TIME_PLUS_23_MINUTE', AckMessageId = '0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY6', AckNoOfRecords = 1, AckBatchStatus = 'ACPT', AckMessageDateTime = 'DATE_TIME_PLUS_23_MINUTE' WHERE RequestUniqueMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY6';
UPDATE _BenefitTransaction SET Status = 'ACKNOWLEDGED_BY_PFMS', AckStatus = 'ACPT' WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY5';
UPDATE _BenefitTransaction SET Status = 'ACKNOWLEDGED_BY_PFMS', AckStatus = 'ACPT' WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY6';
UPDATE _Benefit SET Status = 'PFMS_ACCEPTED', Log = '[{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY5","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY5","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999934","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"First Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'NS' AND IncentiveNumber = 1;
UPDATE _Benefit SET Status = 'PFMS_ACCEPTED', Log = '[{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY6","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY6","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999934","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Tribal Support Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'TS';

UPDATE _BenefitsBatch SET NoOfResponsesReceived = 1, Responses = '[{"MessageId":"0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY5","MessageDateTime":"DATE_TIME_PLUS_25_MINUTE_WITH_TIMEZONE_SEPARATION","RecordCount":1,"DebitAdviceNo":"","ReadAt":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"}]' WHERE RequestUniqueMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY5';
UPDATE _BenefitsBatch SET NoOfResponsesReceived = 1, Responses = '[{"MessageId":"0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY6","MessageDateTime":"DATE_TIME_PLUS_25_MINUTE_WITH_TIMEZONE_SEPARATION","RecordCount":1,"DebitAdviceNo":"","ReadAt":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"}]' WHERE RequestUniqueMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY6';
UPDATE _BenefitTransaction SET Status = 'PFMS_RESPONDED', PfmsTransactionId = CAST((SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY5') AS nvarchar(50)), PfmsTransactionStatus = 'ACCP', CreditDate = 'DATE_TIME_PLUS_24_MINUTE', ResponseInMessageId = '0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY5', InstructionId = CAST((SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY5') AS nvarchar(50)) WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY5';
UPDATE _BenefitTransaction SET Status = 'PFMS_RESPONDED', PfmsTransactionId = CAST((SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY6') AS nvarchar(50)), PfmsTransactionStatus = 'ACCP', CreditDate = 'DATE_TIME_PLUS_24_MINUTE', ResponseInMessageId = '0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY6', InstructionId = CAST((SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY6') AS nvarchar(50)) WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY6';
UPDATE _Benefit SET Status = 'PAID', Log = '[{"UserName":"PFMS","Action":"PFMS_RESPONSE","Comment":"Benefit Credited on DATE_ONLY_PLUS_0_DAY.PFMS Transaction Id - 8. Payment Status in 0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY5","Timestamp":"DATE_TIME_PLUS_24_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY5","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY5","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999934","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"First Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'NS' AND IncentiveNumber = 1;
UPDATE _Benefit SET Status = 'PAID', Log = '[{"UserName":"PFMS","Action":"PFMS_RESPONSE","Comment":"Benefit Credited on DATE_ONLY_PLUS_0_DAY.PFMS Transaction Id - 9. Payment Status in 0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY6","Timestamp":"DATE_TIME_PLUS_24_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY6","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY6","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999934","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Tribal Support Benefit. Date of Notification: DATE_MINUS_3_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'TS Benefit') AND Scheme = 'TS';