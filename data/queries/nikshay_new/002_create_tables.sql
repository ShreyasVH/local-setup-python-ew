create table _Hierarchy( Id int identity primary key, Level int not null, Name nvarchar(255), Type nvarchar(255), Code nvarchar(255), Sector nvarchar(255), Parent_Id int, Level_1_Id int, Level_1_Name nvarchar(255), Level_1_Type nvarchar(255), Level_1_Code nvarchar(255), Level_2_Id int, Level_2_Name nvarchar(255), Level_2_Type nvarchar(255), Level_2_Code nvarchar(255), Level_3_Id int, Level_3_Name nvarchar(255), Level_3_Type nvarchar(255), Level_3_Code nvarchar(255), Level_4_Id int, Level_4_Name nvarchar(255), Level_4_Type nvarchar(255), Level_4_Code nvarchar(255), Level_5_Id int, Level_5_Name nvarchar(255), Level_5_Type nvarchar(255), Level_5_Code nvarchar(255), Level_6_Id int, Level_6_Name nvarchar(255), Level_6_Type nvarchar(255), Level_6_Code nvarchar(255), SuggestedParent_Id int, SuggestedParent_Name nvarchar(255), SuggestedParent_Type nvarchar(255), SuggestedParent_Code nvarchar(255), DrugRegimen nvarchar(20) constraint DF_drugregimen default 'UNKNOWN' not null, HasMERM bit default 0 not null, HasChildren bit default 0 not null, NikshayId varchar(32), ExtraData nvarchar(max), StartDate date, EndDate date, PfmsAgencyMapping int, HandlePfmsAgencyUpdate bit, IsNotActive bit default 0 not null, IsTribal bit default 0 not null, BeneficiaryId int default NULL, EligibleForIncentive bit default 1 not null, GeoLocation geography, PFMSDistrictCode nvarchar(20), PFMSStateCode nvarchar(20), MobileNumber nvarchar(15), HeadquarterPhi int, MermMappingLevel int, Latitude float, Longitude float, MergeStatus nvarchar(50));

create table _Config( Id int identity primary key, Name nvarchar(255) not null, DefaultValue nvarchar(255), Type nvarchar(255) default 'string' not null, unique (Name, DefaultValue));

INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'OverviewComponents', N'Slider', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'OverviewComponents', N'OverallStats', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'ProductAttributes', null, N'ProductAttributes');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'InformantModuleEnabled', N'true', N'bool');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtSchemeCode', N'9156', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'AdherenceSummary_AdherenceFilters', null, N'Dictionary<string, string>');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'AdherenceSummary_DiseaseFilters', null, N'Dictionary<string, string>');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'AdherenceSummary_PatientFilters', null, N'Dictionary<string, string>');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'AdherenceSummary_AdherenceMethodGraph', null, N'ChartDataFromHierarchyConfig');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'AdherenceSummary_DigitalAvgAdherenceGraph', null, N'ChartDataFromHierarchyConfig');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'AdherenceSummary_TodaysAdherenceGraphs', null, N'ChartDataFromHierarchyConfig');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'AdherenceSummary_PendingDosesGraph', null, N'ChartDataFromHierarchyConfig');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'AdherenceSummary_DashboardLinkGraph', null, N'ChartDataFromHierarchyConfig');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'99DotsLite', N'false', N'bool');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtPurposeCodeAndBenficiaryTypeCodeTransitionDate', null, N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtBeneficiaryTypeCodeNS', N'1321', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtBeneficiaryTypeCodeTS', N'968', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtBeneficiaryTypeCodeTSS', N'969', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtBeneficiaryTypeCodePSN', N'970', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtPurposeCodeNS', N'2769', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtPurposeCodeTS', N'1398', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtPurposeCodeTSS_DSTB', N'1399', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtPurposeCodeTSS_DRTB', N'1401', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtPurposeCodePSN', N'1402', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtBeneficiaryMigration', null, N'Dictionary<string, string>');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'TypesOfStats', N'false', N'List<string>');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtCentreAuthorityCodeNS', N'B1TVH', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtCentreAuthorityCodeTS', N'BD8NF', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtCentreAuthorityCodeTSS', N'BF12S', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtCentreAuthorityCodePSN', N'BOGCU', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'STATE_LEVEL_CONTROL', N'0', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'BENEFICIARY_BATCH_DEGREE_OF_PARALLELLISM', N'4', N'int');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'MAX_RECORDS_PER_BEN_BATCH', N'5000', N'int');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'MAX_RECORDS_PER_BENEFIT_RETRIGGER_BATCH', N'300', N'int');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'BENEFIT_RETRIGGER_DEGREE_OF_PARALLELLISM', N'4', N'int');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'BENEFIT_RETRIGGER_SAVE_FOR_100', N'False', N'bool');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'BENEFIT_GENERATION_JOB_DEGREE_OF_PARALLELLISM', N'4', N'int');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'EpisodeEnabledHierarchy', N'false', N'bool');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtPurposeCodeNSOld', N'', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DbtPurposeCodePSNOld', N'', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'NotifiedStages', null, N'List<int>');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DaysDiffForRevert', N'7', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'DaysDiffForRefillDue', N'2', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'BenEntityLinkageBatchSize', N'500000', N'int');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'RiskStratificationEnabled', N'false', N'bool');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'BeneficiaryMigrationBatchSize', N'500', N'int');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'MermMappingLevel', N'1', N'string');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'HasMerm', N'false', N'bool');
INSERT INTO _Config (Name, DefaultValue, Type) VALUES (N'NS_BENEFIT_GENERATION_JOB_DEGREE_OF_PARALLELLISM', N'6', N'int');

create table _HierarchyConfigMap( Id int identity primary key, HierarchyId int not null, ConfigMappingId int not null constraint [FK__HierarchyConfigMap.ConfigMappingId] references _Config, Value nvarchar(max), Active bit default 1 not null);

create table _Beneficiary( Id int identity primary key, BankAccountNo varchar(35), BankId int, PfmsStatus varchar(20) default 'EMPTY' not null, PfmsId varchar(50), LastUpdatedManuallyBy int, LastUpdatedManuallyAt datetime, ValidatedBeneficiaryName varchar(100), StateCode varchar(3), DistrictCode varchar(5), AddedbyDbtMigration bit default 0 not null, TempBeneficiaryType varchar(20), TempNikshayBeneficiaryId varchar(200), PfmsStatusTribal varchar(20), BeneficiaryName nvarchar(520) not null, ValidatingPfmsAgency varchar(100), CurrentPfmsAgency varchar(100), LastBenefitSentToPfmsOn date, TempNikshayId nvarchar(max), TempMigrationId nvarchar(max), PfmsIdTribal varchar(50), EntityType nvarchar(max) default 'C_Patient' not null, IsDeleted bit default 0 not null, DuplicateCount int default 0 not null, StatusBeforeApproval varchar(20), NewBankId int, NewBankAccountNo nvarchar(255), IsVerifiedDuplicate bit default 0 not null, PfmsStatusInformant varchar(20), PfmsIdInformant varchar(50), PhotoProof varchar(255), AccountOwner varchar(255));

create table _FieldStaff( Id int identity primary key, Name nvarchar(255) not null, Designation nvarchar(255), PrimaryNumber nvarchar(15), SecondaryNumber nvarchar(64), EmailAddress nvarchar(255), AddedBy int not null, AddedTimestamp datetime not null, Status nvarchar(15) not null, isActive bit not null, ReceiveSMS bit, SMSFrequency varchar(7), ReceiveEmail bit, EmailFrequency varchar(7), HierarchyMapping int not null, AlertFrequency nvarchar(20) default 'NONE', ReceiveWeeklySummary bit default 0, ReceiveARTAdditionUpdate bit default 1 not null, ReceiveRNTCPAdditionUpdate bit default 1 not null, LinkSomePatients bit default 0 not null, Type nvarchar(max) default 'NONE' not null, DesignationOther nvarchar(max), IsTreatmentSupporter bit default 0 not null, IsEligibleForHonorarium bit default 0 not null, BeneficiaryId int constraint FK_STAFF_BENEFICIARY_ID references _Beneficiary, PaymentTUId int, PersonId int, IsInformant bit);

create table _UserAccess( Id int identity primary key, HierarchyMapping int not null, Description nvarchar(1000), PrimaryNumber nvarchar(100), SecondaryNumber nvarchar(100), EmailAddress nvarchar(300), AddedBy int not null, AddedOn datetime not null, Username nvarchar(255) not null unique, Salt nvarchar(255) not null, Hash nvarchar(64) not null, NumberLogins int, LastLogin datetime, TypeOfPatientsAdded nvarchar(100) not null, tempOldUserId int, ViewOnly bit default 0 not null, CanDeletePatients bit default 1 not null, Deleted bit constraint def_Deleted_0 default 0 not null, Access_Default bit default 0 not null, Access_IndiaTbPublic bit default 0 not null, Access_IndiaTbPrivate bit default 0 not null, StaffId int constraint FK_STAFF_ID references _FieldStaff, IsSelectivePatientMapping bit default 0 not null, PasswordLastRefreshedOn datetime2 default getdate() not null, TypeOfStaffAllowedToAdd nvarchar(max) default 'NONE' not null, AccessType nvarchar(max) default 'ADMIN' not null, IsSelectiveHierarchyMapping bit default 0 not null, IsActive bit default 1 not null);

create table _UserAccessHierarchyMap( Id int identity primary key, UserId int not null constraint FK___UserAcce__UserI__797DF6D1 references _UserAccess, HierarchyId int not null, Relation nvarchar(max), LastUpdatedBy int not null constraint FK___UserAcce__LastU__7A721B0A references _UserAccess, CreatedAt datetime2 not null, UpdatedAt datetime2);

create table _UserPermission( Id int identity constraint [PK_dbo._UserPermission] primary key, UserId int not null constraint [FK__UserPermission.UserId] references _UserAccess, Resource nvarchar(100) not null, ResourceType varchar(100), Operation varchar(100));

create table _AccessGroup( Id int identity primary key, Name nvarchar(255), Type nvarchar(255));

create table _UserAccessGroup( Id int identity primary key, UserId int constraint FK_USER_GROUP_USER_ID references _UserAccess on update cascade on delete cascade, GroupId int constraint FK_USER_GROUP_GROUP_ID references _AccessGroup on update cascade on delete cascade);

create table _Patient( Id int identity constraint PK_Master_Patient primary key, Deleted bit, AddedTimestamp datetime, FirstName nvarchar(255), LastName nvarchar(255), Gender nvarchar(20), Language nvarchar(30), Age int, Occupation nvarchar(255), Address nvarchar(2000), PrimaryPhone nvarchar(15), PreARTNumber nvarchar(255), ARTNumber nvarchar(255), EnrollmentDate datetime2, EndDate datetime, HierarchyMapping_Initiation int, HierarchyMapping_Residence int not null, TypeOfPatient nvarchar(100), CurrentSchedule nvarchar(7), CurrentTags nvarchar(1000), TreatmentOutcome nvarchar(200), AttentionRequired nvarchar(200), AdherenceStatus nvarchar(30), LastDosage datetime, WeightBand int, NewOrPreviouslyTreated nvarchar(255), SiteOfDisease nvarchar(255), EPSite nvarchar(255), TypeOfCase nvarchar(255), HIVTestStatus nvarchar(255), NikshayId nvarchar(255), TBNumber nvarchar(255), TBCategory nvarchar(255), MermId nvarchar(255), DrugRegimen nvarchar(100), TBTreatmentStartDate datetime, AddedBy int constraint FK___Patient__AddedB__25518C17 references _UserAccess, DeploymentCode varchar(10) default 'UNKNOWN' not null, AdherenceString varchar(2048), RegistrationDate datetime2, FathersName nvarchar(100), Pincode nvarchar(100), Taluka nvarchar(100), Town nvarchar(100), Ward nvarchar(200), Landmark nvarchar(100), Stage nvarchar(100) not null, DiagnosisDate datetime2, DiagnosisBasis nvarchar(100), MonitoringMethod nvarchar(100), TreatmentType nvarchar(100), DrugSusceptibility nvarchar(300), RefillMonitoring bit, Area nvarchar(64) default 'Unknown', MaritalStatus nvarchar(64) default 'Unknown', SocioeconomicStatus nvarchar(64) default 'Unknown', KeyPopulation varchar(max) constraint DF_Patient_KeyPopulation default 'Not Applicable', ContactPersonName nvarchar(64), ContactPersonAddress nvarchar(255), ContactPersonPhone nvarchar(64), MonthsOfTreatment int, MonthsSinceEpisode int, TreatmentSource nvarchar(64), Height int, CPInitiationDate datetime2, RegimenType varchar(128), DrugResistance varchar(32), BeneficiaryId int constraint FK_Beneficiary references _Beneficiary, HierarchyMapping_Enrollment int, HierarchyMapping_Diagnosed int, HierarchyMapping_Current int not null, HierarchyMapping_ART int, HierarchyMapping_DRTB int, RemarksOutcome nvarchar(max), MedicalOfficerOutcome nvarchar(255), MigrationStatus nvarchar(20), Latitude real, Longitude real, HierarchyMapping_PVTHUB int, TempNikshayId nvarchar(max), TempMigrationId int, ParentEpisodeId int constraint FK_ParentEpisodeId references _Patient, IsDuplicate bit default 0 not null, DuplicateStatus nvarchar(255), DuplicateOf int constraint FK_DuplicateMapping references _Patient, HierarchyMapping_Outcome int default NULL, IsIAMEnabled bit default 0 not null, ForegoBenefits bit default 0 not null, LastActivityDate datetime2(3) default NULL, TransferId int, Weight int default NULL, TypeOfDOT nvarchar(max), HierarchyMapping_PrivateFacility int, TreatmentPhase nvarchar(10) default 'IP' not null, EndOfIp datetime, TreatmentStartTimeStamp datetime default NULL, PersonId int, AdherenceDispensationRelation bit default 0 not null, StageStatus varchar(100), Symptom varchar(255), TypeOfCaseFinding nvarchar(50), LastMissedDosage datetime, IsEpisodeEnabled bit default 0 not null);

create table _TestResult( Id int identity primary key, PatientId int not null, Type nvarchar(200) not null, Specimen nvarchar(200), VisualAppearanceSputum nvarchar(100), ReportedBy nvarchar(200), DateTested datetime2, DateReported datetime2, HierarchyMapping int, TestingFacilityName nvarchar(200), TestData text, Valid bit not null, Positive bit, AddedBy int not null references _UserAccess, LastUpdatedBy int not null references _UserAccess, AddedOn datetime not null, LastUpdatedOn datetime not null, Stage nvarchar(100) default '', Status nvarchar(64), Reason nvarchar(64), SubReason text, PredominantSymptom nvarchar(64), PredominantSymptomDuration int, HCPVisited int, PreviousATT bit, NikshaySourceTable varchar(100), NikshaySourceId int, DateSpecimenCollected datetime2, DiagRequestId bigint, keep bit default 'TRUE' not null, duplicateOf int);

alter table _Patient add NotificationTestId int constraint FK_NotificationTest_Id references _TestResult;

create table _Comorbidity( Id int identity primary key, PatientId int not null references _Patient, HIVTestingDate datetime2, PIDNumber nvarchar(200), CPTDeliveredDate datetime2, ARTReferralDate datetime2, ARTInitiated nvarchar(20), ARTInitiationDate datetime2, CD4Count nvarchar(200), DiabetesStatus nvarchar(20), RBS nvarchar(200), FBS nvarchar(200), IPEnd nvarchar(200), TreatmentEnd nvarchar(200), AntiDiabeticInitiated nvarchar(20), AntiDiabeticInitiationDate datetime2, OtherComorbidity nvarchar(200), CurrentTobaccoUser nvarchar(20), TobaccoType nvarchar(20), LinkedForCessation nvarchar(20), StatusAtTobaccoTreatmentEnd nvarchar(20), HoAlcoholIntake nvarchar(20), LinkedForDeaddiction nvarchar(20), Covid19Status nvarchar(50), PregnancyStatus nvarchar(50), RCHID nvarchar(200));

create table _ContactTracing( Id int identity primary key, PatientId int not null constraint FK___ContactT__Patie__3F6663D5 references _Patient, NumberOfHouseholdContactsAboveSix int, NumberOfScreenedAboveSix int, NumberOfWithSymptomsAboveSix int, NumberOfEvaluatedAboveSix int, NumberOfDiagnosedAboveSix int, NumberOfOnTreatmentAboveSix int, NumberOfHouseholdContactsBelowSix int, NumberOfScreenedBelowSix int, NumberOfWithSymptomsBelowSix int, NumberOfEvaluatedBelowSix int, NumberOfDiagnosedBelowSix int, NumberOfOnTreatmentBelowSix int, NumberOfChildrenBelowSix int, Name1 nvarchar(100), Weight1 int, Dose1 int, M11 nvarchar(100), M21 nvarchar(100), M31 nvarchar(100), M41 nvarchar(100), M51 nvarchar(100), Name2 nvarchar(100), Weight2 int, Dose2 int, M12 nvarchar(100), M22 nvarchar(100), M32 nvarchar(100), M42 nvarchar(100), M52 nvarchar(100), Name3 nvarchar(100), Weight3 int, Dose3 int, M13 nvarchar(100), M23 nvarchar(100), M33 nvarchar(100), M43 nvarchar(100), M53 nvarchar(100), M61 nvarchar(100), M62 nvarchar(100), M63 nvarchar(100), NumberOfHouseholdContacts int, NumberOfScreened int, NumberOfWithSymptoms int, NumberOfEvaluated int, NumberOfDiagnosed int, NumberOfOnTreatment int, NumberEligibleForTPT int, NumberProvidedTPT int, NumberOfHouseholdContactsAboveFive int, NumberOfScreenedAboveFive int, NumberOfWithSymptomsAboveFive int, NumberOfEvaluatedAboveFive int, NumberOfDiagnosedAboveFive int, NumberOfOnTreatmentAboveFive int, NumberEligibleForTPTAboveFive int, NumberProvidedTPTAboveFive int, NumberOfHouseholdContactsBelowFive int, NumberOfScreenedBelowFive int, NumberOfWithSymptomsBelowFive int, NumberOfEvaluatedBelowFive int, NumberOfDiagnosedBelowFive int, NumberOfOnTreatmentBelowFive int, NumberEligibleForTPTBelowFive int, NumberProvidedTPTBelowFive int);

create table _ContactTracingContact( Id int identity primary key, PatientId int not null constraint FK_ContactTracingContact_Patient references _Patient, ContactPatientId int not null constraint FK_ContactTracingContact_Contact references _Patient, Relation varchar(30) default 'DEFAULT' not null, CreatedAt datetime default getdate() not null, UpdatedAt datetime default getdate() not null);

create table _PatientLog( Id int identity primary key, Category nvarchar(255), UserId int not null, PatientId int not null constraint FK___PatientL__Patie__2A164134 references _Patient, ActionTaken nvarchar(4000), Comments nvarchar(3000), Timestamp datetime not null);

create table _PatientTag( Id int identity constraint PK__PatientTag primary key, PatientId int not null constraint FK___PatientT__Patie__2B0A656D references _Patient, Tag nvarchar(255) not null, Timestamp datetime not null, TagDate date not null);

create table _TransferInOut( Id int identity constraint PK_RntcpTransfer primary key, PatientId int constraint FK___Transfer__Patie__607D3EDD references _Patient, HierarchyType nvarchar(15), HierarchyMapping_From int not null, HierarchyMapping_To int not null, NewAddress nvarchar(2000), MobileNo int, AlternateMobileNo nvarchar(15), Reason nvarchar(250), Date datetime not null, FinalStatus nvarchar(50), Remarks nvarchar(255), UpdatedBy int constraint FK___Transfer__Updat__5E94F66B references _UserAccess, UpdatedDate datetime, IpAddress nvarchar(50), AddedBy int constraint FK___Transfer__Added__5F891AA4 references _UserAccess, AddedOn datetime, Deleted bit, TransferType char, ActionStatus nchar(50), ActionTakenDate datetime, TransferActivityLog nvarchar(max), NatureOfTransfer nvarchar(10));

create table _TransferInOutLog( Id int identity constraint PK_RntcpTransferLog primary key, TransferId int constraint FK_TLOG_TransferId references _TransferInOut, HierarchyMapping_From int not null, HierarchyMapping_To int not null, NewAddress nvarchar(2000), AlternateMobileNo nvarchar(15), Reason nvarchar(250), FinalStatus nvarchar(50), Remarks nvarchar(255), AddedBy int constraint FK_TLOG_AddedBy references _UserAccess, AddedOn datetime, ActionStatus nchar(50), ActionTakenDate datetime, NatureOfTransfer nvarchar(10));

create table _ACFMaster( ACFCode int not null constraint PK__ACFMaster primary key, ACFName nvarchar(150), ACFType char, IsActive bit);

create table _ACFMappingDetails( acfMappingId int identity constraint PK__ACFMappingDetails primary key, hierarchyId int, totalPopulation bigint, aCFCode int, address nvarchar(max), targetPopulation bigint, dateOfMapping date, regBy int constraint fk_regByMapDtl references _UserAccess, regDate datetime, iPFrom nvarchar(20), isActive bit, TempAcf_Mapping_Id int);

create table _ACFReportingDetails( acfReportingId int identity constraint PK__ACFReportingDetails primary key, hierarchyId int, acfMappingId int constraint fk_acfMappingIdRpt references _ACFMappingDetails, ACFCode int, address nvarchar(max), targetPopulation bigint, numScreenedSymptoms int, numExaminedSputum int, numPatientsDiagnosed int, dateOfActivity date, regBy int constraint fk_regByRpt references _UserAccess, regDate datetime, updatedDate datetime, ipFrom nvarchar(max), isActive bit, TempacfReportingId int);

create table _ArchiveLog( Id int identity constraint PK__ArchiveLog primary key, EntityTypeName nvarchar(200) not null, EntityId int not null, PropertyName nvarchar(200), OldValue nvarchar(500), NewValue nvarchar(500), Remarks nvarchar(max), ModifiedBy int not null, ModifiedDate datetime2 not null, IP nvarchar(max), ActionType nvarchar(100));

create table _AuditLog( Id bigint identity constraint [PK_dbo._AuditLog] primary key, EntityTypeName nvarchar(255) not null, EntityId nvarchar(31), PropertyName nvarchar(255) not null, OldValue nvarchar(max), NewValue nvarchar(max), CreatedBy nvarchar(255) not null, UtcTimestamp datetime2 not null);

create table _BankPfms( Id int identity primary key, IfscCode varchar(25), BankName varchar(100) not null, BranchName nvarchar(300), HierarchyMapping int, AddedBy int references _UserAccess, AddedAt datetime default getdate() not null, Micr nvarchar(20), City nvarchar(100), Address nvarchar(400), AddedbyDbtMigration bit default 0 not null, IsUpdated bit default 0, BranchId int, PfmsValidatedBankId int, IsActive bit default 1 not null, UpdatedAt datetime default getdate() not null, MigrationRemarks nvarchar(255), Address2 nvarchar(max), Address3 nvarchar(max), State nvarchar(255), district nvarchar(255), BankShortName nvarchar(20), CBSStatusId int, MigrationId int);

create table _PfmsAgency( Id int identity primary key, Name varchar(200) not null, Code varchar(100) not null constraint UQ_PfmsAgencyCode unique, CreatedAt datetime not null, LastUpdatedDate date not null, AddedbyDbtMigration bit default 0 not null, State varchar(100), AccountNumber varchar(35), AccountHolderName nvarchar(50), AccountType nvarchar(4), LastUpdatedAt datetime2, LastUpdatedById int constraint FK_PfmsAgency_LastUpdatedBy references _UserAccess, BankId int constraint FK_PfmsAgency_BankPfms references _BankPfms, ParentHierarchyId int, ShouldUseDigitalSignature bit default 0 not null, Priority int default 1 not null);

create table _BeneficiaryBatch( Id varchar(16) not null primary key, RequestUniqueMessageId varchar(25) not null unique, RequestMessageDateTime datetime not null, RequestRecordsCount int default 0 not null, DataSource varchar(5) not null, Destination varchar(5) not null, InitiatingPartyName varchar(200) not null, InitiatingPartyCode varchar(100) not null, BatchDate date not null, DaySerialNo int not null, BatchFileCreated bit default 0 not null, UploadedToPfms bit default 0 not null, UploadedToPfmsAt datetime, Responses nvarchar(max), NoOfResponsesReceived int default 0 not null, LastUpdatedAt datetime not null, PfmsAgencyMapping int not null constraint FK_BenBatch_PfmsAgency references _PfmsAgency, constraint unique_batchdate_serial unique (BatchDate, DaySerialNo));

create table _BeneficiaryEntityLinkage( Id int identity primary key, BeneficiaryId int not null references _Beneficiary, EntityId int not null, EntityType nvarchar(50) not null);

create table _BeneficiaryRequest( Id int identity primary key, BatchId varchar(16) not null references _BeneficiaryBatch, BeneficiaryId int not null references _Beneficiary, AgencyId varchar(100) not null, SchemeCode varchar(6), Purpose char not null, PfmsBeneficiaryCode varchar(50), BeneficiaryType varchar(10) not null, BeneficiaryName varchar(100) not null, Gender char not null, Address varchar(150) not null, DistrictCensusCode varchar(5) not null, BankName varchar(100) not null, BranchId varchar(11) not null, BankAccountNo varchar(35) not null, ResponseInMessageId varchar(50), BeneficiaryStatus varchar(4), RejectionReasonCode varchar(max), RejectionReasonNarration varchar(max), BankResponse nvarchar(max), CreatedAt datetime default getdate() not null, LastUpdatedAt datetime not null, AgencyName varchar(200), StateCensusCode varchar(3), constraint UQ_BATCH_BENE_TYPE unique (BatchId, BeneficiaryId, BeneficiaryType));

create table _Benefit( Id int identity primary key, BeneficiaryId int not null references _Beneficiary, HierarchyMapping int not null, Scheme varchar(30) not null, IncentiveNumber int, Status varchar(30) not null, Amount decimal(7, 2) not null, Log nvarchar(max), CreatedAt datetime not null, LastUpdatedManuallyBy int references _UserAccess, LastUpdatedManuallyAt datetime, ProcessingAccountNo varchar(35), ProcessingIfscCode varchar(11), ProcessingAgencyCode varchar(100), Purpose varchar(10) not null, EpisodeId int constraint FK_PatientEpisodeId references _Patient, IsDeleted bit default 0 not null);

create table _BenefitsBatch( RequestUniqueMessageId varchar(25) not null primary key, BatchId varchar(16) not null, BatchDate date not null, DaySerialNo int not null, RequestMessageDateTime datetime not null, RequestRecordCount int not null, RequestControlSum decimal(18, 2) not null, DataSource varchar(5) not null, Destination varchar(5) not null, InitiatingPartyName varchar(200) not null, InitiatingPartyCode varchar(100) not null, BatchFileCreated bit default 0 not null, UploadedToPfms bit default 0 not null, UploadedToPfmsAt datetime, AckReceived bit default 0 not null, AckReadAt datetime, AckMessageId varchar(25), AckNoOfRecords int default 0, AckBatchStatus varchar(4), Responses nvarchar(max), NoOfResponsesReceived int not null, LastUpdatedAt datetime, PfmsAgencyMapping int not null constraint FK_BenefitBatch_PfmsAgency references _PfmsAgency, CentreAuthorityCode varchar(50) not null, AckMessageDateTime datetime, AckRejectionCode nvarchar(max), AckRejectionNarration nvarchar(max), NoOfRetires int default 0, IsSigned bit default 0 not null, RequiredSignatureCount int default 0, Scheme nvarchar(15), LastReviewedAt datetime2, ApprovalStatus nvarchar(50), SchemeCode varchar(6), constraint unique_benefit_batchdate_serial unique (BatchDate, DaySerialNo));

create table _PfmsAgencyUser( Id int identity primary key, Status varchar(200), IsActive bit default 1 not null, Relation nvarchar(50), LastUpdatedAt datetime2, CreatedAt datetime2, PfmsAgencyId int constraint FK_PfmsAgencyUser_PfmsAgency references _PfmsAgency, FieldStaffId int constraint FK_PfmsAgencyUser_FieldStaff references _FieldStaff, AddedById int constraint FK_PfmsAgencyUser_AddedBy references _UserAccess, LastUpdatedById int constraint FK_PfmsAgencyUser_LastUpdatedBy references _UserAccess);

create table _PfmsAgencySignatoryLevel( Id int identity primary key, Level int, MaxAmount int, MinAmount int, LastUpdatedAt datetime2, CreatedAt datetime2, PfmsAgencyId int constraint FK_PfmsAgencySignatoryLevel_PfmsAgency references _PfmsAgency);

create table _SignatoryProfile( Id int identity primary key, Status varchar(50), DSCIssuerDetails nvarchar(2048), DSCSubjectDetails nvarchar(2048), DSCValidFrom datetime2, DSCValidUpto datetime2, DSCSerialNo varchar(16), DSCThumbPrint varchar(100), DSCOwnersName varchar(50), DSCOwnersOrganization varchar(20), DSCIssuer varchar(20), AadhaarNumber varchar(12), PANNumber varchar(10), Designation varchar(35), Department varchar(35), SubDepartment varchar(35), StreetName varchar(35), BuildingNumber varchar(35), PostalCode varchar(6), TownName varchar(35), DistrictCensusCode varchar(35), StateCensusCode varchar(35), PhoneNumber varchar(10), MobileNumber varchar(10), EmailAddress varchar(50) not null, LastUpdatedAt datetime2, CreatedAt datetime2, CertificateAddedById int constraint FK_SignatoryProfile_CertificateAdded_by references _UserAccess, CreatedById int constraint FK_SignatoryProfile_CreatedBy references _UserAccess, LastUpdatedById int constraint FK_SignatoryProfile_LastUpdatedBy references _UserAccess, PfmsAgencyId int constraint FK_SignatoryProfile_PfmsAgency references _PfmsAgency, AgencySignatoryLevelId int constraint FK_SignatoryProfile_SignatoryLevel references _PfmsAgencySignatoryLevel, AgencyUserId int constraint FK_SignatoryProfile_AgencyUser references _PfmsAgencyUser, IsActiveProfile bit default 0 not null);

alter table _SignatoryProfile add NextRecordToActivateId int constraint FK_SignatoryProfile_NextRecordToActivate references _SignatoryProfile;

create table _BenefitBatchApprovalLog( Id int identity primary key, XMLFileName nvarchar(255), SignatoryCertificateSerialNo nvarchar(32), SignatoryLevel int, MD5Hash nvarchar(35), IsFinalSignature bit default 0 not null, CreatedAt datetime2, BatchId varchar(25) constraint FK_BenefitBatchApprovalLog_BenefitsBatch references _BenefitsBatch, SignatoryApprovalStatus nvarchar(50), PfmsUserId int constraint FK_BenefitBatchApprovalLog_Signatory references _PfmsAgencyUser, SignatoryProfileId int constraint FK_BenefitBatchApprovalLog_SignatoryProfile references _SignatoryProfile, UserId int constraint FK_BenefitBatchApprovalLog_User references _UserAccess);

create table _BenefitTransaction( Id int identity primary key, BenefitId int references _Benefit, BeneficiaryId int not null references _Beneficiary, BankName varchar(100) not null, BranchCode varchar(11) not null, PfmsBeneficiaryCode varchar(50) not null, BeneficiaryName varchar(100) not null, BeneficiaryType varchar(10) not null, DistrictCode varchar(5) not null, BankAccountNo varchar(35) not null, Amount decimal(7, 2) not null, PaymentFromDate date not null, PaymentToDate date not null, Status varchar(30) not null, AckStatus varchar(4), AckRejectReasonCode nvarchar(max), AckRejectReasonNarration nvarchar(max), PfmsTransactionId varchar(16), PfmsTransactionStatus varchar(4), CreditDate datetime, RejectionReasonCode nvarchar(max), RejectionReasonNarration nvarchar(max), BankAccountHolderDetails nvarchar(max), ResponseInMessageId varchar(50), CreatedAt datetime not null, LastUpdatedAt datetime not null, PaymentPurpose varchar(10) not null, HierarchyMapping int not null, StateCode varchar(3), InstructionId varchar(32), TempNikshayBeneficiaryId varchar(200), RequestMessageId varchar(25), IsGroupTransaction bit default 0);

alter table _SignatoryProfile add GroupId int constraint FK_BenefitGroup references _BenefitTransaction;

create table _BenefitRetriggerLog( Id int identity primary key, Status varchar(30), AckStatus varchar(4), AckRejectReasonCode nvarchar(max), AckRejectReasonNarration nvarchar(max), PfmsTransactionId varchar(16), PfmsTransactionStatus varchar(4), CreditDate datetime2, RejectionReasonCode nvarchar(max), RejectionReasonNarration nvarchar(max), BankAccountHolderDetails nvarchar(max), ResponseInMessageId varchar(50), BenefitTransactionId int references _BenefitTransaction, BenefitId int references _Benefit, BeneficiaryId int references _Beneficiary, HierarchyMapping int, RequestMessageId varchar(25) references _BenefitsBatch, CreatedAt datetime2, LastUpdatedAt datetime2);

create table _BenefitsApproverOtpDetails( Id int identity primary key with (fillfactor = 90), UserId int not null references _UserAccess, Otp nvarchar(50), CreatedAt datetime2, ValidForSeconds int);

create table _BlacklistedAccountNumber( Id int identity primary key, IFSC nvarchar(255), AccountNumber nvarchar(255));

create table _DefaultEngagement( Id int identity primary key, HierarchyId int not null, DefaultLang int not null, DoseTimings nvarchar(100) not null, DefaultTime nvarchar(50) not null, Languages nvarchar(255), ConsentMandatory bit default 0 not null, NotificationType int);

create table _DeploymentTrigger( Id int identity primary key, HierarchyId int not null, TriggerId int not null, DefaultTemplateId int not null, TemplateIds nvarchar(255), CronTime nvarchar(50), EventName nvarchar(150) not null, EventType nvarchar(150), Mandatory bit default 0, EntityTimeRelated bit default 0, NotificationType nvarchar(50) default 'DEFAULT' not null);

create table _DscEnrollmentBatch( Id varchar(25) not null primary key, PfmsAgencyId int constraint FK_DscEnrollmentBatch_PfmsAgency references _PfmsAgency, BatchDate date not null, DaySerialNo int not null, RequestMessageDateTime datetime2 not null, RequestRecordCount int not null, ProcessId varchar(35) default 'DSC' not null, MndtId varchar(15) not null, InitiatingPartyName varchar(200) not null, InitiatingPartyCode varchar(100) not null, InstitutionId varchar(100) not null, BankAccountNo varchar(35) not null, AccountType varchar(4) not null, AccountHolderName varchar(50) not null, TransactionType varchar(4) not null, SchemeCode varchar(6), BankName varchar(100) not null, IfscCode varchar(11) not null, BatchFileCreated bit default 0 not null, UploadedToPfms bit default 0 not null, UploadedToPfmsAt datetime, AckReceived bit default 0 not null, AckReadAt datetime, AckMessageId varchar(25), AckNoOfRecords int, AckBatchStatus varchar(4), RejectionReasonCode varchar(255), RejectionReasonNarration varchar(max), Status varchar(max), LastUpdatedAt datetime not null);

create table _DscEnrollmentRequest( Id int identity primary key, BatchId varchar(25) not null constraint FK_DscEnrollmentRequest_DscEnrollmentBatch references _DscEnrollmentBatch, DSCValidFrom datetime2 not null, DSCValidUpto datetime2 not null, DSCSerialNo varchar(16) not null, DSCThumbPrint varchar(100) not null, DSCOwnersName varchar(50) not null, DSCOwnersOrganization varchar(20) not null, DSCIssuer varchar(20) not null, Aadhaarnumber varchar(12), PANNumber varchar(10), Designation varchar(35) not null, Department varchar(35) not null, SubDepartment varchar(35) not null, StreetName varchar(35), BuildingNumber varchar(35), PostalCode varchar(6), TownName varchar(35), DistrictCensusCode varchar(35) not null, StateCensusCode varchar(35) not null, PhoneNumber varchar(10), MobileNumber varchar(10), EmailAddress varchar(50) not null, MaxAmount int not null, MinAmount int, RejectionReasonCode varchar(255), RejectionReasonNarration varchar(max), Status varchar(max), LastUpdatedAt datetime2, CreatedAt datetime2, PfmsAgencyId int constraint FK_DscEnrollmentRequest_PfmsAgency references _PfmsAgency, SignatoryId int constraint FK_DscEnrollmentRequest_SignatoryProfile references _SignatoryProfile);

create table _FieldOfficerVisits( Id int identity primary key, FieldOfficerId int not null constraint [FK__FieldOfficerVisits.FieldOfficerId] references _UserAccess, Area nvarchar(max) not null, ProviderId int not null, VisitType int not null, VisitSummary nvarchar(max) not null, Notes nvarchar(max), AddedOn datetime2 not null, DateOfVisitAndTimeOfMeeting datetime2 not null);

create table _GenXModule( ModuleID int identity constraint PK_Module_1 primary key with (fillfactor = 90), GenXHeaderId int, InstrumentSN varchar(50), ModuleSN varchar(50), ModuleName varchar(max), Status varchar(20), StartDate date, EndDate date, Remarks varchar(max), CreatedBy varchar(50), CreatedDateTime datetime constraint DF_Module_CreatedDateTime default getdate(), IPAddress varchar(50), hierarchyId int);

create table _GenXpertHeader( Id int identity constraint PK__GenXpertHeader primary key, hierarchyId int, CSVFileName varchar(50) not null, SystemName varchar(max), ExportedDate varchar(max), ReportUserName varchar(max), AssayInfo varchar(max), AssayVersionInfo varchar(max), AssayTypeInfo varchar(max), AssayDisclaimerInfo varchar(max), SampleIDSettings varchar(max), PatientIDSettings varchar(max), AssaySettings varchar(max), AssayVersionSettings varchar(max), AssayTypeSettings varchar(max), TestTypeSettings varchar(max), SampleTypeSettings varchar(max), NotesSettings varchar(max), regDate datetime not null, regBy int, IpAddress varchar(50));

create table _GenXpertData( Id int identity constraint IX_GeneXpertData unique, GenXHeaderId int constraint FK_Genex_Header_Id references _GenXpertHeader, SampleID varchar(max), PatientID varchar(max), Assay varchar(max), AssayVersion varchar(max), AssayType varchar(max), TestType varchar(max), SampleType varchar(max), Notes varchar(max), TestResult_MTB varchar(max), TestResult_RIF_R varchar(max), TestDisclaimer varchar(max), History varchar(max), CartridgeIndex varchar(max), ModuleName varchar(max), ModuleSN varchar(max), InstrumentSN varchar(max), SWVersion varchar(max), ReagentLotID varchar(max), ExpirationDate varchar(max), StartTime varchar(max), EndTime varchar(max), ErrorStatus varchar(max), Status varchar(max), [User] varchar(max), RunNotes varchar(max), AnalyteResults varchar(max), Details varchar(max), MeltPeaks varchar(max), Errors varchar(max), Messages varchar(max), RunHistory varchar(max), OtherData varchar(max));

alter table _GenXpertData add CartridgeSN varchar(50) not null constraint PK_GeneXpertData primary key;

create table _HierarchyBenefitStatusMap( Id int identity constraint [PK_dbo._HierarchyBenefitStatusMap] primary key, SchemeCode varchar(255), LastBenefitGeneratedAt datetime, HierarchyId int);

create table _MermManagement( Id int identity primary key with (fillfactor = 90), IMEI varchar(20), LastBattery varchar(10), LastSeen datetime, LastOpened datetime, IsActive bit default 0 not null, DeactivatedOn datetime, AlarmEnabled bit default 0 not null, AlarmTime time, RefillAlarmEn bit default 0 not null, RefillDate datetime, RTHours int default 1 not null, HierarchyMapping int, LidFeedback int default 1 not null);

create table _NikshayIdValidation( Id int identity constraint [PK_dbo._NikshayIdValidation] primary key, PatientId int not null constraint [FK__NikshayIdValidation.PatientId] references _Patient, ValidatedNikshayId nvarchar(100), IsValid bit default 1 not null, LastValidatedBy int not null constraint [FK__NikshayIdValidation.LastValidatedAt] references _UserAccess, LastValidatedAt datetime not null, ValidationResponse text not null);

create table _PatientAppConfig( Id int identity primary key, Technology nvarchar(100) not null, Deployment nvarchar(100) not null, AllowDoseMarking bit default 0 not null, ValidationRequired bit default 0 not null, BackdateddoseAllowed bit default 0 not null, BackdatedLimit int not null);

create table _PatientEngagementConfig( PatientId int not null constraint [PK_dbo._PatientEngagementConfig] primary key constraint [FK__PatientEngagementConfig.PatientId] references _Patient, IvrActive bit not null, IvrLanguage nvarchar(20) not null, IvrTimeOfDay nvarchar(20) not null, PatientSMSsActive bit default 0 not null, CallCenterCallsAllowed bit default 0 not null, HouseholdVisitsAllowed bit default 0 not null);

create table _PatientFieldStaffMap( Id int identity primary key, FieldStaffId int not null references _FieldStaff, PatientId int not null constraint FK___PatientF__Patie__29221CFB references _Patient, AddedOn datetime not null, Relationship nvarchar(max) default 'DEFAULT' not null);

create table _PatientFollowUp( Id int identity primary key, PatientId int not null constraint [FK__PatientFollowUp.PatientId] references _Patient, AddedOn datetime2, FollowUpDate datetime2, Mode nvarchar(max), Ailments nvarchar(max), NextFollowUpDate datetime2, DaysOfMedicineLeft int, Addiction nvarchar(max), FollowUpStatus nvarchar(max), MissedDosageReason nvarchar(max), Notes nvarchar(max), MigrantOrTravels bit, HasPeopleToSupport bit, HasFinancialDifficulty bit, HasAnyOtherIssue bit, FeelThatTheyWillGetWellAfterTreatment bit, NoConsentReason nvarchar(max), NoConsentOtherReason nvarchar(max), NextDoctorsVisit datetime2, NextFollowUpType nvarchar(max), FollowUpStatusOther nvarchar(max), AddedBy int not null, NextFollowUpCompleted bit constraint df_NextFollowUpCompleted default 0 not null, PatientWeight nvarchar(max), PatientFeelsImprovement bit);

create table _PhoneMap( Id int identity constraint PK__PhoneMap primary key, PhoneNumber nchar(15) not null, PatientId int not null constraint FK___PhoneMap__Patie__2BFE89A6 references _Patient, isPrimary bit not null, Timestamp datetime not null, PhoneBelongsTo nvarchar(150), StopDateTime datetime, DeploymentCode varchar(10) default 'UNKNOWN' not null);

create table _Refill( Id int identity constraint [PK_dbo._Refill] primary key, RefillId nvarchar(16) not null, PatientId int not null constraint [FK__Refill.PatientId] references _Patient, ProductType1 nvarchar(100) not null, AdultOrPediatric1 nvarchar(100) not null, ProductName1 nvarchar(100) not null, WeightBand1 nvarchar(100), NumberOfDays1 int not null, NumberOfUnits1 int not null, ProductType2 nvarchar(100), AdultOrPediatric2 nvarchar(100), ProductName2 nvarchar(100), WeightBand2 nvarchar(100), NumberOfDays2 int, NumberOfUnits2 int, ProductType3 nvarchar(100), AdultOrPediatric3 nvarchar(100), ProductName3 nvarchar(100), WeightBand3 nvarchar(100), NumberOfDays3 int, NumberOfUnits3 int, ChemistId nvarchar(200), ValidationDate datetime2, Remarks nvarchar(max), Amount decimal(9, 2), AddedBy int not null constraint [FK__Refill.AddedBy] references _UserAccess, InitiationHierarchy int not null);

create table _Regimen( Id int identity primary key, Name nvarchar(255) not null, Disease nvarchar(255) not null);

create table _ScheduleMap( Id int identity constraint PK__ScheduleMap primary key, Schedule nvarchar(7) not null, PatientId int not null constraint FK___Schedule__Patie__2FCF1A8A references _Patient, StartDate datetime not null, TimeStamp datetime not null);

create table _SymptomCheckerLog( MobileNumber varchar(10) not null, SelfTested bit not null, RelationWithConcernedPerson varchar(255), PatientId int, AddedAt datetime not null, AddedBy varchar(255) not null, ExtraData nvarchar(max), AppUrl varchar(255) not null, Platform varchar(255) not null, Id int identity constraint PK__SymptomCheckerLog primary key);

create table _DiagnosticsSample( Id bigint identity constraint [PK_dbo._DiagnosticsSample] primary key, DiagSampleId bigint not null, SampleCollectionSite nvarchar(255), SampleReferralSite nvarchar(255), AddedOn datetime not null, LastUpdatedOn datetime, SampleReferralDate datetime);

create table _ThirdPartyToken( Name nvarchar(40) not null constraint [PK_dbo._ThirdPartyTokens] primary key, Token text not null, Type nvarchar(40), FetchedAtUtc datetime not null, ValidForSeconds int not null);

create table _VendorMapping( Id int identity primary key, VendorId int not null, DeploymentCode varchar(10), NotificationType varchar(255));

create table CallLog( EventId int identity primary key, PatientId int not null, NumberDialled varchar(30), Post varchar(511), AddedTimestamp datetime not null, Who varchar(20), ClientDateTime datetime, UtcDateTime datetime default '1900-01-01 00:00:00' not null, DeploymentCode varchar(10) default 'UNKNOWN' not null);

create table IndiaIvrLog( Id int identity constraint [PK_dbo.IndiaIvrLog] primary key, PatientId int not null, Message varchar(20) not null, Language varchar(20) not null, TimestampIst datetime2 not null, TransId varchar(256) not null);

create table MermLog( Id int identity primary key, EventType varchar(15), QueryString varchar(100), PostBody varchar(400), Timestamp datetime, ResponseCode int, ReponseSuccess bit default 0 not null);

create table _Form( Id int identity primary key, FormLabel varchar(100), FormName varchar(100), SaveEndpoint varchar(255), SaveText varchar(255));

create table _FormPart( Id int identity primary key, PartName varchar(50), PartLabel varchar(100), PartType varchar(50), Rows int, Columns int, Position int, AllowRowOpen bit, AllowRowDelete bit, ListItemTitle varchar(100), ItemDescriptionField varchar(100));

create table _Field( Id int identity primary key with (fillfactor = 90), FieldName varchar(50), Label varchar(100), Component varchar(50), Type varchar(50), IsDisabled int, IsVisible int, IsRequired int, DefaultValue varchar(255), FieldOptions varchar(max), ValidationList varchar(100), RowNumber int, ColumnNumber int, RemoteUrl varchar(255), Config varchar(max));

create table _FieldCustomizations( Id int identity primary key, FieldId int, AttributeName varchar(50), AttributeValue varchar(max));

create table _FieldDependency( Id int identity primary key, Type varchar(50), FormPartId int, FieldId int not null, Lookups varchar(max));

create table _FormItemsMap( Id int identity primary key with (fillfactor = 90), DeploymentCode varchar(50), FormName varchar(50), ItemType varchar(50), ItemId int, ParentType varchar(50), ParentId int);

create table _PatientArchival( PatientId int not null primary key, ArchivalDate datetime not null, ArchivalReason varchar(100) not null);

create table _Merm( Id int identity primary key, IMEI varchar(20) not null unique, LastBattery varchar(10), LastSeen datetime, LastOpened datetime, IsAllocated bit default 0 not null, DeactivatedOn datetime, AlarmEnabled bit, AlarmTime time, RefillAlarmEn bit, RefillDate datetime, RTHours int);

create table _MermPatientMap( Id int identity primary key, MermId int constraint FK___MermPati__MermI__5D60DB10 references _Merm, PatientId int constraint FK___MermPati__Patie__208CD6FA references _Patient, IsActive bit not null, Merm_ActivatedOn datetime not null, Merm_DeactivatedOn datetime, Merm_AlarmEnabled bit default 0 not null, Merm_AlarmTime time, Merm_RefillAlarmEn bit default 0 not null, Merm_RefillDate datetime, Merm_RTHours int default 0 not null);

create index IX___MermPatientMap_MermId on _MermPatientMap (MermId);
create index IX___MermPatientMap_PatientId on _MermPatientMap (PatientId);


