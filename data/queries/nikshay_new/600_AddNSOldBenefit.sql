INSERT INTO _Beneficiary (BankAccountNo, BankId, PfmsStatus, PfmsId, LastUpdatedManuallyBy, LastUpdatedManuallyAt, ValidatedBeneficiaryName, StateCode, DistrictCode, AddedbyDbtMigration, TempBeneficiaryType, TempNikshayBeneficiaryId, PfmsStatusTribal, BeneficiaryName, ValidatingPfmsAgency, CurrentPfmsAgency, LastBenefitSentToPfmsOn, TempNikshayId, TempMigrationId, PfmsIdTribal, EntityType, IsDeleted, DuplicateCount, StatusBeforeApproval, NewBankId, NewBankAccountNo, IsVerifiedDuplicate, PfmsStatusInformant, PfmsIdInformant, PhotoProof, AccountOwner, CreatedAt, UpdatedAt) VALUES (null, null, N'EMPTY', null, null, null, null, N'29', N'536', 0, null, null, N'EMPTY', N'NS Old Benefit', null, null, null, null, null, null, N'C_Patient', 0, 0, null, null, null, 0, N'EMPTY', null, null, null, 'DATE_TIME_PLUS_0_DAY', 'DATE_TIME_PLUS_0_DAY');
INSERT INTO _BeneficiaryEntityLinkage (BeneficiaryId, EntityId, EntityType) VALUES ((SELECT id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), (SELECT Id FROM Foreign_Persons WHERE FirstName = 'NS' AND LastName = 'Old Benefit'), N'Person');

INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'Id', null, CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsStatus', null, N'EMPTY', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'CreatedAt', null, N'DATE_TIME_PLUS_0_DAY_DATE_FIRST', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'UpdatedAt', null, N'DATE_TIME_PLUS_0_DAY_DATE_FIRST', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'StateCode', null, N'29', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'DistrictCode', null, N'536', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'AddedbyDbtMigration', null, N'False', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsStatusTribal', null, N'EMPTY', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'BeneficiaryName', null, N'NS Old Benefit', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'EntityType', null, N'C_Patient', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'IsDeleted', null, N'False', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'DuplicateCount', null, N'0', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'IsVerifiedDuplicate', null, N'False', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsStatusInformant', null, N'EMPTY', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_0_DAY');

INSERT INTO _DiagnosticsSample (DiagSampleId, SampleCollectionSite, SampleReferralSite, AddedOn, LastUpdatedOn, SampleReferralDate) VALUES (10, N'5', null, 'DATE_TIME_PLUS_5_MINUTE', null, null);

INSERT INTO _TestResult (PatientId, Type, Specimen, VisualAppearanceSputum, ReportedBy, DateTested, DateReported, HierarchyMapping, TestingFacilityName, TestData, Valid, Positive, AddedBy, LastUpdatedBy, AddedOn, LastUpdatedOn, Stage, Status, Reason, SubReason, PredominantSymptom, PredominantSymptomDuration, HCPVisited, PreviousATT, NikshaySourceTable, NikshaySourceId, DateSpecimenCollected, DiagRequestId, keep, duplicateOf) VALUES ((Select Id FROM Foreign_Episodes WHERE FirstName = 'NS' AND LastName = 'Old Benefit'), N'Microscopy ZN and Fluorescent', N'Sputum', N'Mucopurulent', null, null, 'DATE_MINUS_90_DAY', 10, N'dmc lab', N'{"FinalInterpretation":"Positive","Remarks":null}', 0, null, (SELECT Id FROM _UserAccess WHERE Username = 'phi-kadha01-001'), (SELECT Id FROM _UserAccess WHERE Username = 'phi-kadha01-001'), 'DATE_TIME_PLUS_5_MINUTE', 'DATE_TIME_PLUS_5_MINUTE', null, N'Results Available', N'Diagnosis of DSTB', N'', null, null, null, 0, null, null, 'DATE_MINUS_91_DAY', 10, 1, null);

INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Id', null, CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'PatientId', null, CAST((SELECT Id FROM Foreign_Episodes WHERE FirstName = 'NS' AND LastName = 'Old Benefit') as nvarchar(50)), N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Type', null, N'Microscopy ZN and Fluorescent', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Specimen', null, N'Sputum', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'VisualAppearanceSputum', null, N'Mucopurulent', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'DateReported', null, 'DATE_MINUS_90_DAY_DATE_FIRST', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'HierarchyMapping', null, N'10', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'TestingFacilityName', null, N'dmc lab', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'TestData', null, N'{"FinalInterpretation":"Positive","Remarks":null}', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Valid', null, N'False', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'AddedBy', null, CAST((SELECT Id FROM _UserAccess WHERE Username = 'phi-KADHA01-001') as nvarchar(50)), N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'LastUpdatedBy', null, CAST((SELECT Id FROM _UserAccess WHERE Username = 'phi-KADHA01-001') as nvarchar(50)), N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'AddedOn', null, 'DATE_TIME_PLUS_5_MINUTE_DATE_FIRST', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'LastUpdatedOn', null, 'DATE_TIME_PLUS_5_MINUTE_DATE_FIRST', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Status', null, N'Results Available', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'Reason', null, N'Diagnosis of DSTB', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'PreviousATT', null, N'False', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'DateSpecimenCollected', null, 'DATE_MINUS_91_DAY_DATE_FIRST', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_TestResult', CAST((SELECT MAX(Id) FROM _TestResult) as nvarchar(50)), N'DiagRequestId', null, N'10', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_5_MINUTE');

#add bank details
UPDATE _Beneficiary SET BankAccountNo = '64000000007', BankId = (SELECT MAX(Id) FROM _BankPfms), PfmsStatus = 'ENTERED', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = 'phi-KADHA01-001'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_10_MINUTE', UpdatedAt = 'DATE_TIME_PLUS_10_MINUTE', PfmsStatusTribal = 'ENTERED', PfmsStatusInformant = 'ENTERED', SeededAt = 'DATE_TIME_PLUS_10_MINUTE' WHERE BeneficiaryName = 'NS Old Benefit';

INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'BankAccountNo', null, N'64000000007', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'BankId', null, CAST((SELECT MAX(Id) FROM _BankPfms) as nvarchar(50)), N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsStatus', N'EMPTY', N'ENTERED', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'LastUpdatedManuallyBy', null, CAST((SELECT Id FROM _UserAccess WHERE Username = 'phi-KADHA01-001') as nvarchar(50)), N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'LastUpdatedManuallyAt', null, 'DATE_TIME_PLUS_10_MINUTE_DATE_FIRST', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'SeededAt', null, 'DATE_TIME_PLUS_10_MINUTE_DATE_FIRST', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'UpdatedAt', 'DATE_TIME_PLUS_9_MINUTE_DATE_FIRST', 'DATE_TIME_PLUS_10_MINUTE_DATE_FIRST', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsStatusTribal', N'EMPTY', N'ENTERED', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsStatusInformant', N'EMPTY', N'ENTERED', N'phi-KADHA01-001', 'UTC_DATE_TIME_PLUS_10_MINUTE');

#generate beneficiary job
UPDATE _Beneficiary SET PfmsStatus = 'SENT', PfmsStatusInformant = 'SENT' WHERE BeneficiaryName = 'NS Old Benefit';
INSERT INTO _BeneficiaryBatch (Id, RequestUniqueMessageId, RequestMessageDateTime, RequestRecordsCount, DataSource, Destination, InitiatingPartyName, InitiatingPartyCode, BatchDate, DaySerialNo, BatchFileCreated, UploadedToPfms, UploadedToPfmsAt, Responses, NoOfResponsesReceived, LastUpdatedAt, PfmsAgencyMapping) VALUES (N'CB0038DATE_PLUS_0_DAY_DDMMYY0001', N'0038DBTBENREQDATE_PLUS_0_DAY_DDMMYYYY1', N'DATE_TIME_PLUS_15_MINUTE', 1, N'0038', N'CPSMS', N'Agency Name', N'AGC', N'DATE_PLUS_0_DAY', 1, 1, 0, null, null, 0, N'DATE_TIME_PLUS_0_DAY', 1);
INSERT INTO _BeneficiaryBatch (Id, RequestUniqueMessageId, RequestMessageDateTime, RequestRecordsCount, DataSource, Destination, InitiatingPartyName, InitiatingPartyCode, BatchDate, DaySerialNo, BatchFileCreated, UploadedToPfms, UploadedToPfmsAt, Responses, NoOfResponsesReceived, LastUpdatedAt, PfmsAgencyMapping) VALUES (N'CB0038DATE_PLUS_0_DAY_DDMMYY0002', N'0038DBTBENREQDATE_PLUS_0_DAY_DDMMYYYY2', N'DATE_TIME_PLUS_15_MINUTE', 1, N'0038', N'CPSMS', N'Agency Name', N'AGC', N'DATE_PLUS_0_DAY', 2, 1, 0, null, null, 0, N'DATE_TIME_PLUS_0_DAY', 1);
INSERT INTO _BeneficiaryRequest (BatchId, BeneficiaryId, AgencyId, SchemeCode, Purpose, PfmsBeneficiaryCode, BeneficiaryType, BeneficiaryName, Gender, Address, DistrictCensusCode, BankName, BranchId, BankAccountNo, ResponseInMessageId, BeneficiaryStatus, RejectionReasonCode, RejectionReasonNarration, BankResponse, CreatedAt, LastUpdatedAt, AgencyName, StateCensusCode) VALUES (N'CB0038DATE_PLUS_0_DAY_DDMMYY0001', (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), N'AGC', N'KA182', N'A', null, N'4282', N'NS Old Benefit', N'M', N'Address', N'536', CAST((SELECT BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON bp.id = b.BankId AND b.BeneficiaryName = 'NS Old Benefit') as NVARCHAR(50)), CAST((SELECT IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp ON bp.id = b.BankId AND b.BeneficiaryName = 'NS Old Benefit') as NVARCHAR(50)), CAST((SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as NVARCHAR(50)), null, null, null, null, null, N'DATE_TIME_PLUS_15_MINUTE', 'DATE_TIME_PLUS_15_MINUTE', N'Agency Name', N'29');
INSERT INTO _BeneficiaryRequest (BatchId, BeneficiaryId, AgencyId, SchemeCode, Purpose, PfmsBeneficiaryCode, BeneficiaryType, BeneficiaryName, Gender, Address, DistrictCensusCode, BankName, BranchId, BankAccountNo, ResponseInMessageId, BeneficiaryStatus, RejectionReasonCode, RejectionReasonNarration, BankResponse, CreatedAt, LastUpdatedAt, AgencyName, StateCensusCode) VALUES (N'CB0038DATE_PLUS_0_DAY_DDMMYY0002', (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), N'AGC', N'KA182', N'A', null, N'4281', N'NS Old Benefit', N'M', N'Not Available', N'536', CAST((SELECT BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON bp.id = b.BankId AND b.BeneficiaryName = 'NS Old Benefit') as NVARCHAR(50)), CAST((SELECT IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp ON bp.id = b.BankId AND b.BeneficiaryName = 'NS Old Benefit') as NVARCHAR(50)), CAST((SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as NVARCHAR(50)), null, null, null, null, null, N'DATE_TIME_PLUS_15_MINUTE', 'DATE_TIME_PLUS_15_MINUTE', N'Agency Name', N'29');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsStatus', N'ENTERED', N'SENT', N'Unknown', 'UTC_DATE_TIME_PLUS_15_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'UpdatedAt', 'DATE_TIME_PLUS_10_MINUTE_DATE_FIRST', 'DATE_TIME_PLUS_11_MINUTE_DATE_FIRST', N'Unknown', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'UpdatedAt', 'DATE_TIME_PLUS_11_MINUTE_DATE_FIRST', 'DATE_TIME_PLUS_12_MINUTE_DATE_FIRST', N'Unknown', 'UTC_DATE_TIME_PLUS_10_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsStatusInformant', N'ENTERED', N'SENT', N'Unknown', 'UTC_DATE_TIME_PLUS_15_MINUTE');

# upload beneficiaries jpb
UPDATE _BeneficiaryBatch SET UploadedToPfms = 1, UploadedToPfmsAt = 'DATE_TIME_PLUS_16_MINUTE' WHERE Id = 'CB0038DATE_PLUS_0_DAY_DDMMYY0001';
UPDATE _BeneficiaryBatch SET UploadedToPfms = 1, UploadedToPfmsAt = 'DATE_TIME_PLUS_16_MINUTE' WHERE Id = 'CB0038DATE_PLUS_0_DAY_DDMMYY0002';

#download and read beneficiary job
UPDATE _Beneficiary SET PfmsStatus = 'VALIDATED', ValidatedBeneficiaryName = 'NS Old Benefit', PfmsId = CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), PfmsStatusInformant = 'VALIDATED', PfmsIdInformant = CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)) WHERE BeneficiaryName = 'NS Old Benefit';
UPDATE _BeneficiaryRequest SET ResponseInMessageId = '0038DBTBENRESDATE_PLUS_0_DAY_DDMMYYYY1', BeneficiaryStatus = 'ACCP', BankResponse = '[{"BankName":"SBI","BranchId":"SBIN0012345","BankAccountNumber":"64000000007","BeneficiaryTitle":null,"BeneficiaryName":null}]', PfmsBeneficiaryCode = CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)) WHERE BatchId = 'CB0038DATE_PLUS_0_DAY_DDMMYY0001';
UPDATE _BeneficiaryRequest SET ResponseInMessageId = '0038DBTBENRESDATE_PLUS_0_DAY_DDMMYYYY2', BeneficiaryStatus = 'ACCP', BankResponse = '[{"BankName":"SBI","BranchId":"SBIN0012345","BankAccountNumber":"64000000007","BeneficiaryTitle":null,"BeneficiaryName":null}]', PfmsBeneficiaryCode = CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)) WHERE BatchId = 'CB0038DATE_PLUS_0_DAY_DDMMYY0002';
UPDATE _BeneficiaryBatch SET Responses = '[{"MessageId":"0038DBTBENRESDATE_PLUS_0_DAY_DDMMYYYY1","MessageDateTime":"DATE_TIME_PLUS_17_MINUTE_WITH_TIMEZONE_SEPARATION","RecordCount":1,"ReadAt":"DATE_TIME_PLUS_17_MINUTE_WITH_TIMEZONE_SEPARATION"}]', NoOfResponsesReceived = 1 WHERE Id = 'CB0038DATE_PLUS_0_DAY_DDMMYY0001';
UPDATE _BeneficiaryBatch SET Responses = '[{"MessageId":"0038DBTBENRESDATE_PLUS_0_DAY_DDMMYYYY2","MessageDateTime":"DATE_TIME_PLUS_17_MINUTE_WITH_TIMEZONE_SEPARATION","RecordCount":1,"ReadAt":"DATE_TIME_PLUS_17_MINUTE_WITH_TIMEZONE_SEPARATION"}]', NoOfResponsesReceived = 1 WHERE Id = 'CB0038DATE_PLUS_0_DAY_DDMMYY0002';
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsStatus', N'SENT', N'VALIDATED', N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsId', null, CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'ValidatedBeneficiaryName', null, N'NS Old Benefit', N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsStatusInformant', N'SENT', N'VALIDATED', N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'PfmsIdInformant', null, CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'Unknown', 'UTC_DATE_TIME_PLUS_18_MINUTE');

# generate benefit job
INSERT INTO _Benefit (BeneficiaryId, HierarchyMapping, Scheme, IncentiveNumber, Status, Amount, Log, CreatedAt, LastUpdatedManuallyBy, LastUpdatedManuallyAt, ProcessingAccountNo, ProcessingIfscCode, ProcessingAgencyCode, Purpose, EpisodeId, IsDeleted) VALUES ((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), 4, N'NS', 1, N'MAKER_PENDING', 1000.00, N'[{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"First Benefit. Date of Notification: DATE_MINUS_90_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_19_MINUTE"}]', 'DATE_TIME_PLUS_19_MINUTE', null, null, null, null, null, N'7175', (Select Id FROM Foreign_Episodes WHERE FirstName = 'NS' AND LastName = 'Old Benefit'), 0);
INSERT INTO _Benefit (BeneficiaryId, HierarchyMapping, Scheme, IncentiveNumber, Status, Amount, Log, CreatedAt, LastUpdatedManuallyBy, LastUpdatedManuallyAt, ProcessingAccountNo, ProcessingIfscCode, ProcessingAgencyCode, Purpose, EpisodeId, IsDeleted) VALUES ((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), 4, N'NS', 2, N'MAKER_PENDING', 500.00, N'[{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1000. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_19_MINUTE"}]', 'DATE_TIME_PLUS_19_MINUTE', null, null, null, null, null, N'7175', (Select Id FROM Foreign_Episodes WHERE FirstName = 'NS' AND LastName = 'Old Benefit'), 0);
INSERT INTO _Benefit (BeneficiaryId, HierarchyMapping, Scheme, IncentiveNumber, Status, Amount, Log, CreatedAt, LastUpdatedManuallyBy, LastUpdatedManuallyAt, ProcessingAccountNo, ProcessingIfscCode, ProcessingAgencyCode, Purpose, EpisodeId, IsDeleted) VALUES ((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), 4, N'NS', 3, N'MAKER_PENDING', 500.00, N'[{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1500. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_19_MINUTE"}]', 'DATE_TIME_PLUS_19_MINUTE', null, null, null, null, null, N'7175', (Select Id FROM Foreign_Episodes WHERE FirstName = 'NS' AND LastName = 'Old Benefit'), 0);
INSERT INTO _Benefit (BeneficiaryId, HierarchyMapping, Scheme, IncentiveNumber, Status, Amount, Log, CreatedAt, LastUpdatedManuallyBy, LastUpdatedManuallyAt, ProcessingAccountNo, ProcessingIfscCode, ProcessingAgencyCode, Purpose, EpisodeId, IsDeleted) VALUES ((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), 4, N'PSN', 1, N'MAKER_PENDING', 500.00, N'[{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Private Provider Informant Incentive for Episode Id : 27. Date of Notification: DATE_MINUS_90_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_19_MINUTE"}]', 'DATE_TIME_PLUS_19_MINUTE', null, null, null, null, null, N'7174', (Select Id FROM Foreign_Episodes WHERE FirstName = 'NS' AND LastName = 'Old Benefit'), 0);

# DBT maker approval
UPDATE _Benefit SET Status = 'APPROVER_PENDING', Log = '[{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"First Benefit. Date of Notification: DATE_MINUS_90_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999938'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_20_MINUTE', UpdatedAt = 'DATE_TIME_PLUS_20_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 1;
UPDATE _Benefit SET Status = 'APPROVER_PENDING', Log = '[{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1000. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999938'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_20_MINUTE', UpdatedAt = 'DATE_TIME_PLUS_20_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 2;
UPDATE _Benefit SET Status = 'APPROVER_PENDING', Log = '[{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1500. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999938'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_20_MINUTE', UpdatedAt = 'DATE_TIME_PLUS_20_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 3;
UPDATE _Benefit SET Status = 'APPROVER_PENDING', Log = '[{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Private Provider Informant Incentive for Episode Id : 27. Date of Notification: DATE_MINUS_90_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_19_MINUTE"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999938'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_20_MINUTE', UpdatedAt = 'DATE_TIME_PLUS_20_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'PSN' AND IncentiveNumber = 1;

# DBT checker approval
UPDATE _Benefit SET Status = 'PFMS_PENDING', Log = '[{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"First Benefit. Date of Notification: DATE_MINUS_90_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999947'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_21_MINUTE', UpdatedAt = 'DATE_TIME_PLUS_21_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 1;
UPDATE _Benefit SET Status = 'PFMS_PENDING', Log = '[{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1000. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999947'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_21_MINUTE', UpdatedAt = 'DATE_TIME_PLUS_21_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 2;
UPDATE _Benefit SET Status = 'PFMS_PENDING', Log = '[{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1500. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999947'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_21_MINUTE', UpdatedAt = 'DATE_TIME_PLUS_21_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 3;
UPDATE _Benefit SET Status = 'PFMS_PENDING', Log = '[{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Private Provider Informant Incentive for Episode Id : 27. Date of Notification: DATE_MINUS_90_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_19_MINUTE"}]', LastUpdatedManuallyBy = (SELECT Id FROM _UserAccess WHERE Username = '9999999947'), LastUpdatedManuallyAt = 'DATE_TIME_PLUS_21_MINUTE', UpdatedAt = 'DATE_TIME_PLUS_21_MINUTE' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'PSN' AND IncentiveNumber = 1;

# generate and upload benefit job
INSERT INTO _BenefitsBatch (RequestUniqueMessageId, BatchId, BatchDate, DaySerialNo, RequestMessageDateTime, RequestRecordCount, RequestControlSum, DataSource, Destination, InitiatingPartyName, InitiatingPartyCode, BatchFileCreated, UploadedToPfms, UploadedToPfmsAt, AckReceived, AckReadAt, AckMessageId, AckNoOfRecords, AckBatchStatus, Responses, NoOfResponsesReceived, LastUpdatedAt, PfmsAgencyMapping, CentreAuthorityCode, AckMessageDateTime, AckRejectionCode, AckRejectionNarration, NoOfRetires, IsSigned, RequiredSignatureCount, Scheme, LastReviewedAt, ApprovalStatus, SchemeCode, CreatedAt) VALUES (N'0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1', N'CP0038DATE_PLUS_0_DAY_DDMMYY0001', N'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', 1, N'DATE_TIME_PLUS_22_MINUTE', 1, 2000.00, N'0038', N'CPSMS', N'Agency Name', (SELECT Code FROM _PfmsAgency WHERE Name = 'Agency Name'), 1, 1, N'DATE_TIME_PLUS_22_MINUTE', 0, null, null, null, null, null, 0, N'DATE_TIME_PLUS_22_MINUTE', (SELECT Id FROM _PfmsAgency WHERE Name = 'Agency Name'), N'EID2L', null, null, null, null, 0, null, N'NS', null, null, N'KA182', 'DATE_TIME_PLUS_22_MINUTE');
INSERT INTO _BenefitsBatch (RequestUniqueMessageId, BatchId, BatchDate, DaySerialNo, RequestMessageDateTime, RequestRecordCount, RequestControlSum, DataSource, Destination, InitiatingPartyName, InitiatingPartyCode, BatchFileCreated, UploadedToPfms, UploadedToPfmsAt, AckReceived, AckReadAt, AckMessageId, AckNoOfRecords, AckBatchStatus, Responses, NoOfResponsesReceived, LastUpdatedAt, PfmsAgencyMapping, CentreAuthorityCode, AckMessageDateTime, AckRejectionCode, AckRejectionNarration, NoOfRetires, IsSigned, RequiredSignatureCount, Scheme, LastReviewedAt, ApprovalStatus, SchemeCode, CreatedAt) VALUES (N'0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY2', N'CP0038DATE_PLUS_0_DAY_DDMMYY0002', N'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', 2, N'DATE_TIME_PLUS_22_MINUTE', 1, 500.00, N'0038', N'CPSMS', N'Agency Name', (SELECT Code FROM _PfmsAgency WHERE Name = 'Agency Name'), 1, 1, N'DATE_TIME_PLUS_22_MINUTE', 0, null, null, null, null, null, 0, N'DATE_TIME_PLUS_22_MINUTE', (SELECT Id FROM _PfmsAgency WHERE Name = 'Agency Name'), N'E4308', null, null, null, null, 0, null, N'PSN', null, null, N'KA182', 'DATE_TIME_PLUS_22_MINUTE');
INSERT INTO _BenefitTransaction (BenefitId, BeneficiaryId, BankName, BranchCode, PfmsBeneficiaryCode, BeneficiaryName, BeneficiaryType, DistrictCode, BankAccountNo, Amount, PaymentFromDate, PaymentToDate, Status, AckStatus, AckRejectReasonCode, AckRejectReasonNarration, PfmsTransactionId, PfmsTransactionStatus, CreditDate, RejectionReasonCode, RejectionReasonNarration, BankAccountHolderDetails, ResponseInMessageId, CreatedAt, LastUpdatedAt, PaymentPurpose, HierarchyMapping, StateCode, InstructionId, TempNikshayBeneficiaryId, RequestMessageId, IsGroupTransaction, GroupId) VALUES (null, (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), (SELECT bp.BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON b.BankId = bp.Id AND b.BeneficiaryName = 'NS Old Benefit'), (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp ON b.BankId = bp.Id AND b.BeneficiaryName = 'NS Old Benefit'), CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AS nvarchar(50)), N'NS Old Benefit', N'4282', N'536', (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), 2000.00, 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', N'SENT_TO_PFMS', null, null, null, null, null, null, null, null, null, null, 'DATE_TIME_PLUS_22_MINUTE', 'DATE_TIME_PLUS_22_MINUTE', N'7942', 4, N'29', null, null, N'0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1', 1, null);
INSERT INTO _BenefitTransaction (BenefitId, BeneficiaryId, BankName, BranchCode, PfmsBeneficiaryCode, BeneficiaryName, BeneficiaryType, DistrictCode, BankAccountNo, Amount, PaymentFromDate, PaymentToDate, Status, AckStatus, AckRejectReasonCode, AckRejectReasonNarration, PfmsTransactionId, PfmsTransactionStatus, CreditDate, RejectionReasonCode, RejectionReasonNarration, BankAccountHolderDetails, ResponseInMessageId, CreatedAt, LastUpdatedAt, PaymentPurpose, HierarchyMapping, StateCode, InstructionId, TempNikshayBeneficiaryId, RequestMessageId, IsGroupTransaction, GroupId) VALUES ((SELECT Id FROM _Benefit WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') And Scheme = 'NS' AND IncentiveNumber = 1), (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), (SELECT bp.BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON b.BankId = bp.Id AND b.BeneficiaryName = 'NS Old Benefit'), (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp on b.BankId = bp.Id AND b.BeneficiaryName = 'NS Old Benefit'), CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'NS Old Benefit', N'4282', N'536', (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), 1000.00, 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', N'SENT_TO_PFMS', null, null, null, null, null, null, null, null, null, null, N'DATE_TIME_PLUS_22_MINUTE', N'DATE_TIME_PLUS_22_MINUTE', N'7942', 4, N'29', null, null, N'PART-OF-GROUP-TRANSACTION', null, 1);
INSERT INTO _BenefitTransaction (BenefitId, BeneficiaryId, BankName, BranchCode, PfmsBeneficiaryCode, BeneficiaryName, BeneficiaryType, DistrictCode, BankAccountNo, Amount, PaymentFromDate, PaymentToDate, Status, AckStatus, AckRejectReasonCode, AckRejectReasonNarration, PfmsTransactionId, PfmsTransactionStatus, CreditDate, RejectionReasonCode, RejectionReasonNarration, BankAccountHolderDetails, ResponseInMessageId, CreatedAt, LastUpdatedAt, PaymentPurpose, HierarchyMapping, StateCode, InstructionId, TempNikshayBeneficiaryId, RequestMessageId, IsGroupTransaction, GroupId) VALUES ((SELECT Id FROM _Benefit WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') And Scheme = 'NS' AND IncentiveNumber = 2), (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), (SELECT bp.BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON b.BankId = bp.Id AND b.BeneficiaryName = 'NS Old Benefit'), (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp on b.BankId = bp.Id AND b.BeneficiaryName = 'NS Old Benefit'), CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'NS Old Benefit', N'4282', N'536', (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), 500.00, 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', N'SENT_TO_PFMS', null, null, null, null, null, null, null, null, null, null, N'DATE_TIME_PLUS_22_MINUTE', N'DATE_TIME_PLUS_22_MINUTE', N'7942', 4, N'29', null, null, N'PART-OF-GROUP-TRANSACTION', null, 1);
INSERT INTO _BenefitTransaction (BenefitId, BeneficiaryId, BankName, BranchCode, PfmsBeneficiaryCode, BeneficiaryName, BeneficiaryType, DistrictCode, BankAccountNo, Amount, PaymentFromDate, PaymentToDate, Status, AckStatus, AckRejectReasonCode, AckRejectReasonNarration, PfmsTransactionId, PfmsTransactionStatus, CreditDate, RejectionReasonCode, RejectionReasonNarration, BankAccountHolderDetails, ResponseInMessageId, CreatedAt, LastUpdatedAt, PaymentPurpose, HierarchyMapping, StateCode, InstructionId, TempNikshayBeneficiaryId, RequestMessageId, IsGroupTransaction, GroupId) VALUES ((SELECT Id FROM _Benefit WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') And Scheme = 'NS' AND IncentiveNumber = 3), (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), (SELECT bp.BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON b.BankId = bp.Id AND b.BeneficiaryName = 'NS Old Benefit'), (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp on b.BankId = bp.Id AND b.BeneficiaryName = 'NS Old Benefit'), CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'NS Old Benefit', N'4282', N'536', (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), 500.00, 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', N'SENT_TO_PFMS', null, null, null, null, null, null, null, null, null, null, N'DATE_TIME_PLUS_22_MINUTE', N'DATE_TIME_PLUS_22_MINUTE', N'7942', 4, N'29', null, null, N'PART-OF-GROUP-TRANSACTION', null, 1);
INSERT INTO _BenefitTransaction (BenefitId, BeneficiaryId, BankName, BranchCode, PfmsBeneficiaryCode, BeneficiaryName, BeneficiaryType, DistrictCode, BankAccountNo, Amount, PaymentFromDate, PaymentToDate, Status, AckStatus, AckRejectReasonCode, AckRejectReasonNarration, PfmsTransactionId, PfmsTransactionStatus, CreditDate, RejectionReasonCode, RejectionReasonNarration, BankAccountHolderDetails, ResponseInMessageId, CreatedAt, LastUpdatedAt, PaymentPurpose, HierarchyMapping, StateCode, InstructionId, TempNikshayBeneficiaryId, RequestMessageId, IsGroupTransaction, GroupId) VALUES ((SELECT Id FROM _Benefit WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') And Scheme = 'PSN' AND IncentiveNumber = 1), (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), (SELECT bp.BankName FROM _Beneficiary b INNER JOIN _BankPfms bp ON b.BankId = bp.Id AND b.BeneficiaryName = 'NS Old Benefit'), (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp ON b.BankId = bp.Id AND b.BeneficiaryName = 'NS Old Benefit'), CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AS nvarchar(50)), N'NS Old Benefit', N'4281', N'536', (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), 500.00, 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY', N'SENT_TO_PFMS', null, null, null, null, null, null, null, null, null, null, 'DATE_TIME_PLUS_22_MINUTE', 'DATE_TIME_PLUS_22_MINUTE', N'7174', 4, N'29', null, null, N'0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY2', null, null);
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'UpdatedAt', 'DATE_TIME_PLUS_12_MINUTE_DATE_FIRST', 'DATE_TIME_PLUS_23_MINUTE_DATE_FIRST', N'Unknown', 'UTC_DATE_TIME_PLUS_23_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'LastBenefitSentToPfmsOn', null, N'DATE_PLUS_0_DAY_DATE_FIRST', N'Unknown', 'UTC_DATE_TIME_PLUS_23_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'UpdatedAt', 'DATE_TIME_PLUS_12_MINUTE_DATE_FIRST', 'DATE_TIME_PLUS_23_MINUTE_DATE_FIRST', N'Unknown', 'UTC_DATE_TIME_PLUS_23_MINUTE');
INSERT INTO _AuditLog (EntityTypeName, EntityId, PropertyName, OldValue, NewValue, CreatedBy, UtcTimestamp) VALUES (N'C_Beneficiary', CAST((SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') as nvarchar(50)), N'LastBenefitSentToPfmsOn', null, N'DATE_PLUS_0_DAY_DATE_FIRST', N'Unknown', 'UTC_DATE_TIME_PLUS_23_MINUTE');
UPDATE _Beneficiary SET LastBenefitSentToPfmsOn = 'DATE_ONLY_YEAR_FIRST_PLUS_0_DAY' WHERE BeneficiaryName = 'NS Old Benefit';
UPDATE _Benefit SET Status = 'PFMS_SENT', UpdatedAt = 'DATE_TIME_PLUS_22_MINUTE', Log = '[{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"First Benefit. Date of Notification: DATE_MINUS_90_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE_WITH_TIMEZONE_SEPARATION"}]', ProcessingAccountNo = (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), ProcessingIfscCode =  (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp on bp.Id = b.BankId and b.BeneficiaryName = 'NS Old Benefit'), ProcessingAgencyCode = (SELECT Code FROM _PfmsAgency WHERE Name = 'Agency Name') WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 1;
UPDATE _Benefit SET Status = 'PFMS_SENT', UpdatedAt = 'DATE_TIME_PLUS_22_MINUTE', Log = '[{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1000. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_18_MINUTE_WITH_TIMEZONE_SEPARATION"}]', ProcessingAccountNo = (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), ProcessingIfscCode =  (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp on bp.Id = b.BankId and b.BeneficiaryName = 'NS Old Benefit'), ProcessingAgencyCode = 'AGC' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 2;
UPDATE _Benefit SET Status = 'PFMS_SENT', UpdatedAt = 'DATE_TIME_PLUS_22_MINUTE', Log = '[{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1500. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_18_MINUTE_WITH_TIMEZONE_SEPARATION"}]', ProcessingAccountNo = (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), ProcessingIfscCode =  (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp on bp.Id = b.BankId and b.BeneficiaryName = 'NS Old Benefit'), ProcessingAgencyCode = 'AGC' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 3;
UPDATE _Benefit SET Status = 'PFMS_SENT', UpdatedAt = 'DATE_TIME_PLUS_22_MINUTE', Log = '[{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY2","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Private Provider Informant Incentive for Episode Id : 27. Date of Notification: DATE_MINUS_90_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_19_MINUTE"}]', ProcessingAccountNo = (SELECT BankAccountNo FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit'), ProcessingIfscCode =  (SELECT bp.IfscCode FROM _Beneficiary b INNER JOIN _BankPfms bp on bp.Id = b.BankId and b.BeneficiaryName = 'NS Old Benefit'), ProcessingAgencyCode = (SELECT Code FROM _PfmsAgency WHERE Name = 'Agency Name') WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'PSN' AND IncentiveNumber = 1;

# download and read benefits job
UPDATE _BenefitsBatch SET AckReceived = 1, AckReadAt = 'DATE_TIME_PLUS_23_MINUTE', AckMessageId = '0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY1', AckNoOfRecords = 1, AckBatchStatus = 'ACPT', AckMessageDateTime = 'DATE_TIME_PLUS_23_MINUTE' WHERE RequestUniqueMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1';
UPDATE _BenefitsBatch SET AckReceived = 1, AckReadAt = 'DATE_TIME_PLUS_23_MINUTE', AckMessageId = '0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY2', AckNoOfRecords = 1, AckBatchStatus = 'ACPT', AckMessageDateTime = 'DATE_TIME_PLUS_23_MINUTE' WHERE RequestUniqueMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY2';
UPDATE _BenefitTransaction SET Status = 'ACKNOWLEDGED_BY_PFMS', AckStatus = 'ACPT' WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1' AND IsGroupTransaction = 1;
UPDATE _BenefitTransaction SET Status = 'ACKNOWLEDGED_BY_PFMS', AckStatus = 'ACPT' WHERE GroupId = (SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1' AND IsGroupTransaction = 1);
UPDATE _BenefitTransaction SET Status = 'ACKNOWLEDGED_BY_PFMS', AckStatus = 'ACPT' WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY2';
UPDATE _Benefit SET Status = 'PFMS_ACCEPTED', UpdatedAt = 'DATE_TIME_PLUS_23_MINUTE', Log = '[{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"First Benefit. Date of Notification: DATE_MINUS_90_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE_WITH_TIMEZONE_SEPARATION"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 1;
UPDATE _Benefit SET Status = 'PFMS_ACCEPTED', UpdatedAt = 'DATE_TIME_PLUS_23_MINUTE', Log = '[{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1000. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_18_MINUTE_WITH_TIMEZONE_SEPARATION"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 2;
UPDATE _Benefit SET Status = 'PFMS_ACCEPTED', UpdatedAt = 'DATE_TIME_PLUS_23_MINUTE', Log = '[{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1500. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_18_MINUTE_WITH_TIMEZONE_SEPARATION"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 3;
UPDATE _Benefit SET Status = 'PFMS_ACCEPTED', UpdatedAt = 'DATE_TIME_PLUS_23_MINUTE', Log = '[{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY2","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY2","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Private Provider Informant Incentive for Episode Id : 27. Date of Notification: DATE_MINUS_90_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_19_MINUTE"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'PSN' AND IncentiveNumber = 1;

UPDATE _BenefitsBatch SET NoOfResponsesReceived = 1, Responses = '[{"MessageId":"0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY1","MessageDateTime":"DATE_TIME_PLUS_25_MINUTE_WITH_TIMEZONE_SEPARATION","RecordCount":1,"DebitAdviceNo":"","ReadAt":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"}]' WHERE RequestUniqueMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1';
UPDATE _BenefitsBatch SET NoOfResponsesReceived = 1, Responses = '[{"MessageId":"0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY2","MessageDateTime":"DATE_TIME_PLUS_25_MINUTE_WITH_TIMEZONE_SEPARATION","RecordCount":1,"DebitAdviceNo":"","ReadAt":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"}]' WHERE RequestUniqueMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY2';
UPDATE _BenefitTransaction SET Status = 'PFMS_RESPONDED', PfmsTransactionId = CAST((SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1') AS nvarchar(50)), PfmsTransactionStatus = 'ACCP', CreditDate = 'DATE_TIME_PLUS_24_MINUTE', ResponseInMessageId = '0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY1', InstructionId = CAST((SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1') AS nvarchar(50)) WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1' AND IsGroupTransaction = 1;
UPDATE _BenefitTransaction SET Status = 'PFMS_RESPONDED', PfmsTransactionId = CAST((SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1') AS nvarchar(50)), PfmsTransactionStatus = 'ACCP', CreditDate = 'DATE_TIME_PLUS_24_MINUTE', ResponseInMessageId = '0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY1', InstructionId = CAST((SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1') AS nvarchar(50)) WHERE GroupId = (SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1' AND IsGroupTransaction = 1);
UPDATE _BenefitTransaction SET Status = 'PFMS_RESPONDED', PfmsTransactionId = CAST((SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY2') AS nvarchar(50)), PfmsTransactionStatus = 'ACCP', CreditDate = 'DATE_TIME_PLUS_24_MINUTE', ResponseInMessageId = '0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY2', InstructionId = CAST((SELECT Id FROM _BenefitTransaction WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY2') AS nvarchar(50)) WHERE RequestMessageId = '0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY2';
UPDATE _Benefit SET Status = 'PAID', UpdatedAt = 'DATE_TIME_PLUS_24_MINUTE', Log = '[{"UserName":"PFMS","Action":"PFMS_RESPONSE","Comment":"Benefit Credited on DATE_ONLY_PLUS_0_DAY.PFMS Transaction Id - 1. Payment Status in 0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_24_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"First Benefit. Date of Notification: DATE_MINUS_90_DAY_DDMMYYYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_18_MINUTE_WITH_TIMEZONE_SEPARATION"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 1;
UPDATE _Benefit SET Status = 'PAID', UpdatedAt = 'DATE_TIME_PLUS_24_MINUTE', Log = '[{"UserName":"PFMS","Action":"PFMS_RESPONSE","Comment":"Benefit Credited on DATE_ONLY_PLUS_0_DAY.PFMS Transaction Id - 1. Payment Status in 0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_24_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1000. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_18_MINUTE_WITH_TIMEZONE_SEPARATION"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 2;
UPDATE _Benefit SET Status = 'PAID', UpdatedAt = 'DATE_TIME_PLUS_24_MINUTE', Log = '[{"UserName":"PFMS","Action":"PFMS_RESPONSE","Comment":"Benefit Credited on DATE_ONLY_PLUS_0_DAY.PFMS Transaction Id - 1. Payment Status in 0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_24_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY1","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_19_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Recurring Benefit. Treatment Start Date: DATE_MINUS_89_DAY_DDMMYYYY_HYPHENATED. Benefits Already Created: INR 1500. Number Of Months Eligible: 4 (1 month advance)","Timestamp":"DATE_TIME_PLUS_18_MINUTE_WITH_TIMEZONE_SEPARATION"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'NS' AND IncentiveNumber = 3;
UPDATE _Benefit SET Status = 'PAID', UpdatedAt = 'DATE_TIME_PLUS_24_MINUTE', Log = '[{"UserName":"PFMS","Action":"PFMS_RESPONSE","Comment":"Benefit Credited on DATE_ONLY_PLUS_0_DAY.PFMS Transaction Id - 5. Payment Status in 0038DBTPAYSTSDATE_PLUS_0_DAY_DDMMYYYY2","Timestamp":"DATE_TIME_PLUS_24_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"PFMS","Action":"COMMENT","Comment":"Benefit Accepted. Payment Response in 0038DBTPAYRESDATE_PLUS_0_DAY_DDMMYYYY2","Timestamp":"DATE_TIME_PLUS_23_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"SEND_TO_PFMS","Comment":"Sent to PFMS in 0038DBTPAYREQDATE_PLUS_0_DAY_DDMMYYYY2","Timestamp":"DATE_TIME_PLUS_22_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999947","Action":"APPROVE_BY_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_21_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"9999999938","Action":"SEND_TO_APPROVER","Comment":null,"Timestamp":"DATE_TIME_PLUS_20_MINUTE_WITH_TIMEZONE_SEPARATION"},{"UserName":"NIKSHAY","Action":"COMMENT","Comment":"Private Provider Informant Incentive for Episode Id : 27. Date of Notification: DATE_MINUS_90_DAY_DDMMYY_HYPHENATED","Timestamp":"DATE_TIME_PLUS_19_MINUTE"}]' WHERE BeneficiaryId = (SELECT Id FROM _Beneficiary WHERE BeneficiaryName = 'NS Old Benefit') AND Scheme = 'PSN' AND IncentiveNumber = 1;